<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DevOps for Data Science - 4&nbsp; Logging and Monitoring</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/sec1/1-5-docker.html" rel="next">
<link href="../../chapters/sec1/1-3-proj-components.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BTSMMRMH08"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-BTSMMRMH08', { 'anonymize_ip': true});
</script>


</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Logging and Monitoring</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">DevOps for Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/akgold/do4ds" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Welcome!</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/intro.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/sec1/1-0-sec-intro.html" class="sidebar-item-text sidebar-link">DevOps Lessons for Data Science</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-1-code-promotion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Code promotion and integration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-2-env-as-code.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Environments as Code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-3-proj-components.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Science Project Architecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-4-monitor-log.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Logging and Monitoring</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-5-docker.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Docker for Data Science</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/sec2/2-0-sec-intro.html" class="sidebar-item-text sidebar-link">Tools of the IT/Admin</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/2-1-terminal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The Terminal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/2-2-ssh.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Connecting Securely with SSH</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/2-3-cmd-line.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Getting comfortable on the Command Line</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/sec3/3-0-sec-intro.html" class="sidebar-item-text sidebar-link">The DIY Data Science Environment</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-1-cloud.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Getting Started with the Cloud</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-2-linux-admin.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Basic Linux SysAdmin</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-3-networking.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Intro to Computer Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-4-dns.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">DNS allows for human-readable addresses</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-5-ssl.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">SSL/HTTPS are the most basic network security tools</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-6-servers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Choosing the right server for you</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/sec4/4-0-sec-intro.html" class="sidebar-item-text sidebar-link">Making it Enterprise-Grade</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec4/4-1-os-ds-in-ent.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Open Source Data Science in the Enterprise</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec4/4-2-secure-networking.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Upgraded Networking</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec4/4-3-auth.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Logging in with auth</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec4/4-4-scaling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Scaling</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/append/docker-cheatsheet.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Docker Cheatsheet</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#observing-data-science" id="toc-observing-data-science" class="nav-link active" data-scroll-target="#observing-data-science"><span class="toc-section-number">4.1</span>  Observing data science</a></li>
  <li><a href="#working-with-logs-and-metrics" id="toc-working-with-logs-and-metrics" class="nav-link" data-scroll-target="#working-with-logs-and-metrics"><span class="toc-section-number">4.2</span>  Working with logs and metrics</a>
  <ul class="collapse">
  <li><a href="#how-to-write-logs" id="toc-how-to-write-logs" class="nav-link" data-scroll-target="#how-to-write-logs"><span class="toc-section-number">4.2.1</span>  How to write logs</a></li>
  <li><a href="#how-to-emit-metrics" id="toc-how-to-emit-metrics" class="nav-link" data-scroll-target="#how-to-emit-metrics"><span class="toc-section-number">4.2.2</span>  How to emit metrics</a></li>
  <li><a href="#consuming-logs-and-metrics" id="toc-consuming-logs-and-metrics" class="nav-link" data-scroll-target="#consuming-logs-and-metrics"><span class="toc-section-number">4.2.3</span>  Consuming Logs and Metrics</a></li>
  </ul></li>
  <li><a href="#comprehension-questions" id="toc-comprehension-questions" class="nav-link" data-scroll-target="#comprehension-questions"><span class="toc-section-number">4.3</span>  Comprehension Questions</a></li>
  <li><a href="#portfolio-exercise-adding-logging" id="toc-portfolio-exercise-adding-logging" class="nav-link" data-scroll-target="#portfolio-exercise-adding-logging"><span class="toc-section-number">4.4</span>  Portfolio Exercise: Adding Logging</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/akgold/do4ds/edit/main/chapters/sec1/1-4-monitor-log.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-log-monitor" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Logging and Monitoring</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Say something goes wrong with your ETL job today, or your app fails for some reason. It would be much better to find out from an email or slack message rather than from an angry message about wrong numbers ending up in front of your company’s CTO. And when you do catch it, wouldn’t it be nice to have some documentation of what happened so you can reconstruct the sequence of events and figure out what actually went wrong?</p>
<p>Obviously, the answer is yes to both of these.</p>
<p>Observability is the DevOps term for generally whether you can peer inside the operations of your system to see what’s going on and figure out what happened when something goes awry.</p>
<p>In general, people talk about two sides of observability: <em>logging</em> and <em>monitoring</em>.</p>
<p>Logging is the process of documenting and saving a record of what happened when a piece of software ran. The output of the logging process is a log. Logs are useful for documenting what’s happening inside a software system under both normal operations and reconstructing the sequence of events prior to a failure.</p>
<p>Monitoring is the process of keeping live metrics of how the system is doing. Metrics are quantitative measurements of system resources – things like CPU, RAM, and disk usage as well as numbers of users and response times. Monitoring is the process of generating those metrics, making sure they’re within normal parameters, and alerting the appropriate people or systems if something goes awry.</p>
<p>There are four things you might try to learn from your observations of your app, job, API, or report.</p>
<p>The first is to understand what your job or model is doing. Are your data joins correct? Is the data quality about the same as you expect, or is it deteriorating? Is your model performing as well as you need and as well as it usually does, or is something strange happening?</p>
<p>The second is to understand access patterns. Are people visiting your app or report? Are they visiting particular parts more than others? This is useful both for understanding the dynamics of your app and what parts are most useful and also making the case inside your organization that you are doing valuable work.</p>
<p>The third is to create a trail of who accessed or did what. In some organizations, creating an <em>audit trail</em> is mandatory if your app actually creates or writes data. In other cases it’s just useful to know if particular users are using the app in particular ways.</p>
<p>And lastly, it’s useful to have logging in your app to reconstruct what happened just prior to an error. In general, the only way to fix an error is going to be re-creating the state of the system just before the error occurred. Logging enough information that you can do so is extremely useful. Moreover, having enough instrumentation that you can turn on more aggressive logging and just run through that app state is a way you can be really kind to future you.</p>
<p>For both monitoring and logging, there are two separate things to think about: how does your system <em>emit</em> logs and metrics, and how are you consuming those logs and metrics to make them useful.</p>
<p>TODO: diagram of monitoring + logging emission vs aggregation</p>
<p>For data scientists, the main concerns you’ll have around observability are emitting logs from any products you’ve created and emitting performance metrics in a machine-learning context. There are industry-standard tools you can use for consuming those logs and metrics.</p>
<section id="observing-data-science" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="observing-data-science"><span class="header-section-number">4.1</span> Observing data science</h2>
<p>When software engineers think about observability, they’re generally thinking about observing the <em>operational</em> qualities of their app. They’re trying to answer questions like are people using it? Is the app operational or are users experiencing errors? Is performance good enough?</p>
<p>As data scientists, we likely have another level of logging to think about, which is the level of the actual data science operations, especially when machine learning models are involved. How are our models performing? Is the level of model performance stable, or is it changing over time? Are our data queries still working or has the data collection process found some new exciting way to mess up our ETL pipeline?</p>
<p>But there’s good news – you’re probably already pretty used to data science logging.</p>
<p>A lot of data science work is done in a literate programming format – Jupyter Notebooks, R Markdown Documents, and Quarto Documents. If used right, the beauty of these documents is that they are self-logging on the data science side!</p>
<p>And in my opinion, you should do <em>all</em> your jobs in a literate programming format. Some people really like running jobs as <code>.R</code> or <code>.py</code> files – that’s fine, but then you also need to make sure your job is emitting the right logs and metrics. On the other hand, if you write your code in a literate programming format and keep an archive of a few runs, you’ve got a self-logging job.</p>
<p>Now it’s worth spending a few minutes thinking about the things you’ll want to make sure you note in a job to make sure its useful as a log. The number one thing I log is the quality of data joins. When these go awry, your downstream data can get really confusing. It’s also often worthwhile to do cross tabulations of recodes, to make sure your recode logic is working like you think it is. And obviously, if you’re doing modeling, you’ll want to log some metrics around model quality.</p>
<p>But we don’t get to ignore the software engineering concerns of a good service experience for our users. This makes observability <em>even more</em> important in a data science context than in a pure software engineering one.</p>
<p>In the data science context, you’ll need to do more than literate programming. You’ll want to get comfortable with how and what to log from your jobs, apps, and APIs, and how to emit metrics in a way that can be consumed by the kinds of services you want.</p>
</section>
<section id="working-with-logs-and-metrics" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="working-with-logs-and-metrics"><span class="header-section-number">4.2</span> Working with logs and metrics</h2>
<p>Emitting logs can be straightforward. It can be as simple as just putting <code>print</code> statements throughout your code. Now, there are much better ways to do logging, but print statements are a start.</p>
<p>Whether you need to emit metrics is a more subtle question. In many data science contexts, you aren’t going to do monitoring on a real-time basis, so emitting metrics that can be used by a real-time monitoring system is less important than for other types of software.</p>
<p>And you’re a data scientist – if you’re putting information into your logs, it’s probably not hard to scrape that data into structured metrics data should the need ever arise. That said, the barrier to entry for actually emitting metrics is way lower than you might realize, and most data scientists should probably pay more attention to emitting metrics than they do.</p>
<section id="how-to-write-logs" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="how-to-write-logs"><span class="header-section-number">4.2.1</span> How to write logs</h3>
<p>As I mentioned, logging can be as simple as a bunch of print statements in your code. However, there are tools that make it way easier and more pleasant to create and use logs than just a bunch of manual print statements.</p>
<p>Python has a standard logging package that is excellent and you should use that. R does not have a standard logging package, but there are a number of excellent CRAN packages for logging. My personal favorite is <a href="https://cran.r-project.org/web/packages/log4r/index.html"><code>log4r</code></a>.</p>
<p>Let’s develop a quick mental model of how logging works inside software.</p>
<p>Let’s say you’ve decided that you should log every time the user presses a particular button. In your code, you’re going to do the following. First you’re going to call a <em>logger</em>. The logger is the runtime object that actually does the logging. When you call the logger, you’re going to specify the <em>log data</em> as well as a <em>log level</em>. In this case, the message would be something like, “Button pressed”. The logger aggregates the data, the level, and anything you’ve already specified should be added to each record – like a timestamp or the user – and turns that into a <em>log record</em>.</p>
<p>Now, you’ve got to <em>do</em> something with the log record. The logging software does this via a <em>handler</em> (called an <em>appender</em> in the <code>log4r</code> package). There are three general options for what might happen to your log record. The first (and most common) option is to save the log record to a file on disk. This file is saved somewhere where you can access it later. Many logging consumers are very comfortable watching a file somewhere and aggregating lines of the log as they are written to the file.</p>
<p>You may additionally – or instead – want your log emitted somewhere on the system. In Linux, there are two common places to emit logs: <em>stdout</em> (standard output) and <em>stderr</em> (standard error). These are the typical places that messages are emitted – normal ones to <em>stdout</em> and errors to <em>stderr</em>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Emitting to stdout
</div>
</div>
<div class="callout-body-container callout-body">
<p>These days, the most common reason to emit to standard outputs rather than save to a file on disk is because you’re running inside a Docker container. As we’ll get into more in <a href="1-5-docker.html">Chapter&nbsp;<span>5</span></a>, anything that lives inside a Docker container is ephemeral. This is obviously bad if it’s possible that the things you’re trying to log will be important in the event the Docker container is unexpectedly killed.</p>
<p>For running inside a Docker container (including in Kubernetes), a common pattern is to emit logs on <em>stdout</em> and <em>stderr</em> and have a service outside the container that consumes them and writes them somewhere more permanent and/or aggregates them.</p>
</div>
</div>
<p>If you are emitting logs to file, you may also want to consider how long those logs stay around. <em>Log rotation</em> is the process of storing logs for a period of time and then deleting the old ones. A common log rotation pattern is to have a 24-hour log file. Each day, the system automatically sets up a new log file and deletes the oldest one (30 days is a typical retention period). The Python <code>logging</code> library does log rotation itself. <code>log4r</code> does not, but there is a Linux library called <code>logrotate</code> that you can use in concert with <code>log4r</code>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>Lastly, it’s possible you want to do something else completely different with your logs. This is most typical when you want logs of a certain level of criticality sent to an outside system immediately. For example, maybe you want to send the log as a slack message or text in the event a production system goes down.</p>
<p>As the log record is written, it has to be formatted using a <em>formatter</em> or <em>layout</em>. In most cases, the default log format is in plain text. So if you log “Button pressed” at the info level, your log record might look something like this in the file:</p>
<pre><code>2022-11-18 21:57:50 INFO Button Pressed</code></pre>
<p>But if you’re shipping your logs off to have them consumed by some other service, you might prefer to have a highly structured log file. The most common structured logging format is JSON, though it’s also possible to use something like YAML or XML. If you used JSON logging, the same record might be emitted as:</p>
<pre><code>{
  "time": "2022-11-18 21:57:50",
  "level": "INFO", 
  "data": "Button Pressed"
}</code></pre>
<p>Most logging libraries have 5-7 levels of logging. Both the Python <code>logging</code> library and <code>log4r</code> use the five levels below:</p>
<ol type="1">
<li>Critical: an error so big that the app itself shuts down. For example, if your app cannot run without a connection to an outside service, you might log an inability to connect as a Critical error.</li>
<li>Error: an issue that will make an operation not work, but that won’t bring down your app. In the language of software engineering, you might think of this as a caught exception. An example might be a user submitting invalid input.</li>
<li>Warn/Warning: an unexpected application issue that isn’t fatal. For example, you might include having to retry doing something or noticing that resource usage is high. If something were to go wrong later, these might be helpful breadcrumbs to look at.</li>
<li>Info: something normal happened in the app. These record things like starting and stopping, successfully making database and other connections, and configuration options that are used.</li>
<li>Debug: a deep record of what the app was doing. The debug log is meant for people who understand the app code to be able to understand what functions ran and with what arguments.</li>
</ol>
<section id="a-shiny-app-that-logs" class="level4" data-number="4.2.1.1">
<h4 data-number="4.2.1.1" class="anchored" data-anchor-id="a-shiny-app-that-logs"><span class="header-section-number">4.2.1.1</span> A Shiny App that logs</h4>
<p>Here’s a silly function. It counts normally up to 5, but returns <code>NaN</code> starting at 5 and then forevermore if you use the output as the new input.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource {r}} number-lines code-with-copy"><code class="sourceCode"><span id="cb3-1"><a href="#cb3-1"></a>counter &lt;- function(n) {</span>
<span id="cb3-2"><a href="#cb3-2"></a>  # Do some math</span>
<span id="cb3-3"><a href="#cb3-3"></a>  n &lt;- n %% 5 # Do a modulous for no reason</span>
<span id="cb3-4"><a href="#cb3-4"></a>  n &lt;- n + n/n # Add n/n (it's always 1, right?)</span>
<span id="cb3-5"><a href="#cb3-5"></a>  n</span>
<span id="cb3-6"><a href="#cb3-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>And here’s a Shiny app that renders a number and a button you can use to “Count to Infinity!” Unfortunately, it uses our fatally flawed <code>counter</code> function, so it will stop working after 5.</p>
<p>You can see in the app that I’ve already implemented some logging. At the beginning, I create a logger using the standard defaults and then log that the app is starting. You can also see that I log every time the button gets pressed.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource {r}} number-lines code-with-copy"><code class="sourceCode"><span id="cb4-1"><a href="#cb4-1"></a>library(shiny)</span>
<span id="cb4-2"><a href="#cb4-2"></a>library(log4r)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a># Create log object</span>
<span id="cb4-5"><a href="#cb4-5"></a>log &lt;- logger()</span>
<span id="cb4-6"><a href="#cb4-6"></a># Log startup</span>
<span id="cb4-7"><a href="#cb4-7"></a>info(log, paste("App starting"))</span>
<span id="cb4-8"><a href="#cb4-8"></a>n &lt;- reactiveVal(1)</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a>ui &lt;- fluidPage(</span>
<span id="cb4-11"><a href="#cb4-11"></a>  titlePanel(</span>
<span id="cb4-12"><a href="#cb4-12"></a>    "Count to Infinity!"</span>
<span id="cb4-13"><a href="#cb4-13"></a>  ),</span>
<span id="cb4-14"><a href="#cb4-14"></a>  mainPanel(</span>
<span id="cb4-15"><a href="#cb4-15"></a>    actionButton(</span>
<span id="cb4-16"><a href="#cb4-16"></a>      "button", "Next Number"</span>
<span id="cb4-17"><a href="#cb4-17"></a>    ),</span>
<span id="cb4-18"><a href="#cb4-18"></a>    textOutput("number")</span>
<span id="cb4-19"><a href="#cb4-19"></a>  )</span>
<span id="cb4-20"><a href="#cb4-20"></a>)</span>
<span id="cb4-21"><a href="#cb4-21"></a></span>
<span id="cb4-22"><a href="#cb4-22"></a>server &lt;- function(input, output) {</span>
<span id="cb4-23"><a href="#cb4-23"></a>  observeEvent(</span>
<span id="cb4-24"><a href="#cb4-24"></a>    input$button, {</span>
<span id="cb4-25"><a href="#cb4-25"></a>      info(log, "Button Pressed")</span>
<span id="cb4-26"><a href="#cb4-26"></a>      # Increment value of count reactive</span>
<span id="cb4-27"><a href="#cb4-27"></a>      n(counter(n(), log))</span>
<span id="cb4-28"><a href="#cb4-28"></a>    })</span>
<span id="cb4-29"><a href="#cb4-29"></a></span>
<span id="cb4-30"><a href="#cb4-30"></a>  output$number &lt;- renderText(n())</span>
<span id="cb4-31"><a href="#cb4-31"></a>}</span>
<span id="cb4-32"><a href="#cb4-32"></a></span>
<span id="cb4-33"><a href="#cb4-33"></a># Run the application</span>
<span id="cb4-34"><a href="#cb4-34"></a>shinyApp(ui = ui, server = server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you’re eagle-eyed, you’ll also notice that I’m passing the log object into the counter function. I’ve modified it to do some logging, allowing me to debug log the value of <code>n</code> after I take the modulo and logging an error if <code>n</code> isn’t a number.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource {r}} number-lines code-with-copy"><code class="sourceCode"><span id="cb5-1"><a href="#cb5-1"></a>counter &lt;- function(n, log) {</span>
<span id="cb5-2"><a href="#cb5-2"></a>  # Do some math</span>
<span id="cb5-3"><a href="#cb5-3"></a>  n &lt;- n %% 5 # Do a modulous for no reason</span>
<span id="cb5-4"><a href="#cb5-4"></a>  debug(log, paste("n:", n))</span>
<span id="cb5-5"><a href="#cb5-5"></a>  n &lt;- n + n/n # Add n/n (it's always 1, right?)</span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a>  # Error if it's not a number</span>
<span id="cb5-8"><a href="#cb5-8"></a>  if (is.nan(n)) error(log, "n is not a number")</span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a>  n</span>
<span id="cb5-11"><a href="#cb5-11"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>So if I launch this app, here’s what comes out in the logs. Note that by default, it’s just printing to the console. In a production setting, I might want to configure where the log goes in the call to the <code>logger</code> function.</p>
<pre><code>&gt; runApp()
INFO  [2022-11-19 12:06:43] App starting
INFO  [2022-11-19 12:06:46] Button Pressed
INFO  [2022-11-19 12:06:47] Button Pressed
INFO  [2022-11-19 12:06:48] Button Pressed
INFO  [2022-11-19 12:06:50] Button Pressed
ERROR [2022-11-19 12:06:50] n is not a number</code></pre>
<p>If this was deployed in production and I got a call that my app was consistently returning <code>NaN</code>, this is pretty helpful. I can see that the app started normally, the button got pressed a few times just fine and then it started returning something that isn’t a number.</p>
<p>You’ll notice that my debug printing of <code>n</code> doesn’t appear anywhere though. That’s because it’s standard for logging packages only to print down to the <code>INFO</code> level by default. If I want <code>DEBUG</code> logging, I’ll have to turn that on by changing the logger creator line to read</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource {r}} number-lines code-with-copy"><code class="sourceCode"><span id="cb7-1"><a href="#cb7-1"></a>log &lt;- logger("DEBUG")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>One nice thing about having a dev environment like we discussed in <a href="1-1-code-promotion.html">Chapter&nbsp;<span>1</span></a> is that you can have that environment configured to <em>always</em> do debug logging using a config setting to set the log level.</p>
</div>
</div>
<p>Now when I run my app, I get the following logs:</p>
<pre><code>&gt; runApp()
INFO  [2022-11-19 12:18:57] App starting
INFO  [2022-11-19 12:19:00] Button Pressed
DEBUG [2022-11-19 12:19:00] n: 2
INFO  [2022-11-19 12:19:00] Button Pressed
DEBUG [2022-11-19 12:19:00] n: 3
INFO  [2022-11-19 12:19:01] Button Pressed
DEBUG [2022-11-19 12:19:01] n: 4
INFO  [2022-11-19 12:19:01] Button Pressed
DEBUG [2022-11-19 12:19:01] n: 0
ERROR [2022-11-19 12:19:01] n is not a number</code></pre>
<p>Aha! Now it might be obvious to me that I’m dividing 0 by 0 in my code and I can go fix it, all without having to actually step through my code line-by-line.</p>
</section>
</section>
<section id="how-to-emit-metrics" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="how-to-emit-metrics"><span class="header-section-number">4.2.2</span> How to emit metrics</h3>
<p>Emitting metrics is somewhat more complicated than emitting logs, and for many use cases it won’t be necessary. As I mentioned above, in many cases just scraping logs for any metrics you need is good enough. But if you need to do more complex metrics emission and aggregation, you’ve still got great options.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Metrics for ModelOps
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s worth noting that the most common reasons Data Scientists need metrics is if they’re running ML models in production. As I’m writing, there are a variety of frameworks and tools vying to be the top in this arena.</p>
<p>Each of the major cloud providers has their own model hosting solution that includes monitoring capabilities, and there are many other paid options as well.</p>
<p>For open source usage, I am (perhaps unsurprisingly) partial to the <a href="https://rstudio.github.io/vetiver-r/index.html">vetiver</a> package being developed for both R and python by my colleagues at Posit.</p>
</div>
</div>
<p>These days, most people use the Prometheus/Grafana stack for open source monitoring. <a href="https://prometheus.io/">Prometheus</a> is an open source monitoring tool that makes it easy to store metrics data, query that data, and alert based on it. <a href="https://grafana.com/">Grafana</a> is an open source dashboarding tool that sits on top of Prometheus to do visualization of the metrics. They are usually used together to do monitoring and visualization of metrics.</p>
<p>It’s very easy to monitor the server your data science asset might sit on. Prometheus includes something called a <em>node exporter</em>, which makes it extremely easy to monitor the system resources of your server.</p>
<p>The way this works is that your Data Science asset emits metrics in a format that Prometheus recognizes, Prometheus watches the metrics and stores them and alerts if necessary, and you have a Grafana dashboard available for visualizing those metrics as needed.</p>
<p>Python has an official Prometheus client you can use for emitting metrics from a Python asset, and the <a href="https://github.com/atheriel/openmetrics">openmetrics</a> package in R makes it easy to emit metrics from a Plumber API or (experimentally) a Shiny app.</p>
<p>QUESTION FOR READERS - do I need to do an example that includes emitting metrics?</p>
</section>
<section id="consuming-logs-and-metrics" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="consuming-logs-and-metrics"><span class="header-section-number">4.2.3</span> Consuming Logs and Metrics</h3>
<p>Once you’ve got your asset instrumented and your logging going, you’ll want to use them. If you’re using a professional product like Posit Connect to host your asset, you will probably get some degree of support for finding and reading relevant logs out of the box.</p>
<p>If not, you’ll probably be making good use of the skills we’ll review in <a href="../sec3/3-2-linux-admin.html">Chapter&nbsp;<span>10</span></a> to watch logs and parse them.</p>
<p>You also can configure the Prometheus and Grafana stack to do both metrics monitoring and log aggregation. Grafana provides a generous free tier that allows you to use Prometheus and Grafana to do your monitoring without having to set up your own server. You can just set up their service and point your app to it.</p>
<p>There’s a great <a href="https://grafana.com/docs/grafana/latest/getting-started/get-started-grafana-prometheus/">Get Started with Grafana and Prometheus</a> doc on the GrafanaLabs website if you want to actually try it out.</p>
</section>
</section>
<section id="comprehension-questions" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="comprehension-questions"><span class="header-section-number">4.3</span> Comprehension Questions</h2>
<ol type="1">
<li>What is the difference between monitoring and logging? What are the two halves of the monitoring and logging process?</li>
<li>In general, logging is good, but what are some things you should be careful <em>not to log</em>?</li>
<li>At what level would you log each of the following events:
<ol type="1">
<li><p>Someone clicks on a particular tab in your Shiny app.</p></li>
<li><p>Someone puts an invalid entry into a text entry box.</p></li>
<li><p>An <code>http</code> call your app makes to an external API fails.</p></li>
<li><p>The numeric values that are going into your computational function.</p></li>
</ol></li>
</ol>
</section>
<section id="portfolio-exercise-adding-logging" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="portfolio-exercise-adding-logging"><span class="header-section-number">4.4</span> Portfolio Exercise: Adding Logging</h2>
<p>Start with the app you built for <a href="1-3-proj-components.html">Chapter&nbsp;<span>3</span></a>.</p>
<p>Using the appropriate package for whichever language you wrote in, add robust logging to both the API and the App you built.</p>
<p>For an extra challenge, consider trying to emit Prometheus metrics as well and consume them using Prometheus and Grafana.</p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>There are two common naming patterns with rotating log files. The first is to have dated log filenames that look like <code>my-log-20221118.log</code>.</p>
<p>The other pattern is to keep one file that’s current and have the older ones numbered. So today’s log would be <code>my-log.log</code>, yesterday’s would be <code>my-log.log.1</code> , the day before <code>my-log.log.2</code>, etc. This second pattern works particularly well if you’re using <code>logrotate</code> with <code>log4r</code>, because then <code>log4r</code> doesn’t need to know anything about the log rotation. It’s just always writing to <code>my-log.log</code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../chapters/sec1/1-3-proj-components.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Science Project Architecture</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/sec1/1-5-docker.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Docker for Data Science</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2022, Alex K Gold</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/akgold/do4ds" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/alexkgold">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>