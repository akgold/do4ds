<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DevOps for Data Science - 8&nbsp; Administering a Linux Server</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/sec2/2-4-understanding-traffic.html" rel="next">
<link href="../../chapters/sec2/2-2-cmd-line.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BTSMMRMH08"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-BTSMMRMH08', { 'anonymize_ip': true});
</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Administering a Linux Server</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">DevOps for Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/akgold/do4ds" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Welcome!</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/intro.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/sec1/1-0-sec-intro.html" class="sidebar-item-text sidebar-link">DevOps Lessons for Data Science</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-1-code-promotion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Code promotion and integration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-2-env-as-code.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Environments as Code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-3-proj-components.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Science Project Architecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-4-monitor-log.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Logging and Monitoring</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-5-docker.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Docker for Data Science</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/sec2/2-0-sec-intro.html" class="sidebar-item-text sidebar-link">The DIY Data Science Environment</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/2-1-cloud.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Getting Started with the Cloud</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/2-2-cmd-line.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">The Command Line + SSH</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/2-3-linux-admin.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Administering a Linux Server</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/2-4-understanding-traffic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Computer Networks and the Internet</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/2-5-servers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Choosing the right server for you</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/sec3/3-0-sec-intro.html" class="sidebar-item-text sidebar-link">Making it Enterprise-Grade</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-1-os-ds-in-ent.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Open Source Data Science in the Enterprise</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-2-secure-networking.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Upgraded Networking</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-3-auth.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Logging in with auth</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-4-scaling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Scaling</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/append/docker-cheatsheet.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Docker Cheatsheet</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#a-little-about-linux" id="toc-a-little-about-linux" class="nav-link active" data-scroll-target="#a-little-about-linux"><span class="toc-section-number">8.1</span>  A little about Linux</a></li>
  <li><a href="#a-tiny-intro-to-linux-administration" id="toc-a-tiny-intro-to-linux-administration" class="nav-link" data-scroll-target="#a-tiny-intro-to-linux-administration"><span class="toc-section-number">8.2</span>  A tiny intro to Linux administration</a></li>
  <li><a href="#the-filesystem-files-and-editing-text" id="toc-the-filesystem-files-and-editing-text" class="nav-link" data-scroll-target="#the-filesystem-files-and-editing-text"><span class="toc-section-number">8.3</span>  The filesystem, files, and editing text</a>
  <ul class="collapse">
  <li><a href="#reading-text-files" id="toc-reading-text-files" class="nav-link" data-scroll-target="#reading-text-files"><span class="toc-section-number">8.3.1</span>  Reading text files</a></li>
  <li><a href="#deleting-and-moving-files" id="toc-deleting-and-moving-files" class="nav-link" data-scroll-target="#deleting-and-moving-files"><span class="toc-section-number">8.3.2</span>  Deleting and Moving Files</a></li>
  <li><a href="#moving-things-to-and-from-the-server" id="toc-moving-things-to-and-from-the-server" class="nav-link" data-scroll-target="#moving-things-to-and-from-the-server"><span class="toc-section-number">8.3.3</span>  Moving things to and from the server</a></li>
  <li><a href="#writing-files---a-rough-intro-to-vim" id="toc-writing-files---a-rough-intro-to-vim" class="nav-link" data-scroll-target="#writing-files---a-rough-intro-to-vim"><span class="toc-section-number">8.3.4</span>  Writing files - a rough intro to <code>vim</code></a></li>
  </ul></li>
  <li><a href="#managing-who-can-do-what" id="toc-managing-who-can-do-what" class="nav-link" data-scroll-target="#managing-who-can-do-what"><span class="toc-section-number">8.4</span>  Managing who can do what</a>
  <ul class="collapse">
  <li><a href="#file-permissions" id="toc-file-permissions" class="nav-link" data-scroll-target="#file-permissions"><span class="toc-section-number">8.4.1</span>  File Permissions</a></li>
  </ul></li>
  <li><a href="#managing-server-resources" id="toc-managing-server-resources" class="nav-link" data-scroll-target="#managing-server-resources"><span class="toc-section-number">8.5</span>  Managing server resources</a>
  <ul class="collapse">
  <li><a href="#managing-storage" id="toc-managing-storage" class="nav-link" data-scroll-target="#managing-storage"><span class="toc-section-number">8.5.1</span>  Managing storage</a></li>
  <li><a href="#running-processes" id="toc-running-processes" class="nav-link" data-scroll-target="#running-processes"><span class="toc-section-number">8.5.2</span>  Running processes</a></li>
  </ul></li>
  <li><a href="#managing-networking" id="toc-managing-networking" class="nav-link" data-scroll-target="#managing-networking"><span class="toc-section-number">8.6</span>  Managing networking</a>
  <ul class="collapse">
  <li><a href="#practical-ssh" id="toc-practical-ssh" class="nav-link" data-scroll-target="#practical-ssh"><span class="toc-section-number">8.6.1</span>  Practical SSH</a></li>
  </ul></li>
  <li><a href="#lab-setting-up-a-user-configuring-ssh-installing-r-python-and-more" id="toc-lab-setting-up-a-user-configuring-ssh-installing-r-python-and-more" class="nav-link" data-scroll-target="#lab-setting-up-a-user-configuring-ssh-installing-r-python-and-more"><span class="toc-section-number">8.7</span>  Lab: Setting up a user, configuring SSH, Installing R, Python, and More</a>
  <ul class="collapse">
  <li><a href="#creating-an-ssh-key-for-the-user" id="toc-creating-an-ssh-key-for-the-user" class="nav-link" data-scroll-target="#creating-an-ssh-key-for-the-user"><span class="toc-section-number">8.7.1</span>  Creating an SSH Key for the user</a></li>
  <li><a href="#getting-data-science-tools-running" id="toc-getting-data-science-tools-running" class="nav-link" data-scroll-target="#getting-data-science-tools-running"><span class="toc-section-number">8.7.2</span>  Getting Data Science Tools Running</a></li>
  <li><a href="#installing-rstudio-server" id="toc-installing-rstudio-server" class="nav-link" data-scroll-target="#installing-rstudio-server"><span class="toc-section-number">8.7.3</span>  Installing RStudio Server</a></li>
  <li><a href="#installing-jupyerhub-jupyterlab" id="toc-installing-jupyerhub-jupyterlab" class="nav-link" data-scroll-target="#installing-jupyerhub-jupyterlab"><span class="toc-section-number">8.7.4</span>  Installing JupyerHub + JupyterLab</a></li>
  <li><a href="#running-as-a-service" id="toc-running-as-a-service" class="nav-link" data-scroll-target="#running-as-a-service"><span class="toc-section-number">8.7.5</span>  Running as a service</a></li>
  </ul></li>
  <li><a href="#comprehension-questions" id="toc-comprehension-questions" class="nav-link" data-scroll-target="#comprehension-questions"><span class="toc-section-number">8.8</span>  Comprehension Questions</a>
  <ul class="collapse">
  <li><a href="#questions-for-alex" id="toc-questions-for-alex" class="nav-link" data-scroll-target="#questions-for-alex"><span class="toc-section-number">8.8.1</span>  Questions for Alex</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/akgold/do4ds/edit/main/chapters/sec2/2-3-linux-admin.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-linux-admin" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Administering a Linux Server</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Now that you’ve got a Linux server and you’re able to log in, it’s time to get acquainted with your server, learn how to move around, and start getting some things done.</p>
<p>There are two big differences between your laptop and a Linux server that you’ll have to get used to. The first is that servers generally do not have graphical user interfaces (GUIs) for doing administrative tasks. If you want to adjust the system settings on your laptop or navigate from directory to directory, you can click through a file tree or open up your preferences pane. For the most case, all interaction you’re going to have with your server is going to be via the command line. It’s easier than you might think if you’ve never done it before, but it’ll take a little learning.</p>
<p><img src="images-servers/desktop-vs-server.drawio.svg" title="Desktop vs Server" class="img-fluid"></p>
<p>The second difference is that the server we set up runs Linux – as do the overwhelming majority of the world’s servers. If you’re interacting with the command line, the differences between Linux and other operating systems (especially MacOS) aren’t huge, but there’s a little learning involved.</p>
<p>In order to get started, this section is going to be around navigating in Linux and learning how to do some basic administrative tasks. There are entire books written about Linux System Administration. Pick up one of those if you’re curious.</p>
<section id="a-little-about-linux" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="a-little-about-linux"><span class="header-section-number">8.1</span> A little about Linux</h2>
<p>Every computer in the world runs on an operating system. The operating system defines the way that applications – like Microsoft Word, RStudio, and Minecraft – can interact with the underlying hardware. They define how files are stored and accessed, how applications are installed and can connect to networks, and more.</p>
<p>TODO: Image of hardware, operating system, applications</p>
<p>Back in the early days of computing, basically every computer manufacturer created its own operating system that was super-tightly linked to the hardware. These days, there are only a few operating systems that most systems use.</p>
<p>For desktop and laptop computers, there’s Windows, MacOS, and Linux; Windows and Linux for servers, and Android (actually a flavor of Linux) and iOS for phones and tablets.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>The 1960s were a wild time for operating systems. Basically every computer company invented their own operating system for their machines. In the early 1970s, AT&amp;T labs released a proprietary operating system called Unix.</p>
<p>Unix espoused a philosophy of small system-level programs that could be chained together to do more complex things. It turned out that this philosophy made a lot of sense, and starting in the early 1980s, a variety of <em>Unix-like</em> operating systems were released. Unix-like operating systems were clones – they behaved like Unix, but didn’t actually include any code from Unix (because it was proprietary).</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This philosophy, called piping, should feel extremely familiar to you if you’re an R user. The tidyverse pipe <code>%&gt;%</code> and the base R pipe introduced in R 4.1 <code>|&gt;</code> are both directly inspired by the Unix/Linux pipe <code>|</code>.</p>
</div>
</div>
<p>Linux is the most successful of those clones, an open source Unix-like operating system released in 1991 by software engineer Linus Torvalds.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> Another of those clones was the predecessor to what is now MacOS.</p>
<p>A difference you’ve probably experienced before between Unix-like systems and Windows, which is not Unix-like is the type of slashes used in file paths. Unix-like systems use forward slashes <code>/</code>, while Windows uses back slashes <code>\</code>.</p>
<p>A huge majority of the world’s servers run on Linux. There are meaningful Windows server deployments in some enterprises, but it’s relatively small compared to the install base of Linux servers. Along with most of the world’s servers, almost all of the world’s embedded computers – in ATMs, cars and planes, TVs, and most other gadgets and gizmos – run on Linux. If you have an Android phone or a Chromebook – that’s Linux. Basically all of the world’s supercomputers use Linux.</p>
<p>As you might imagine, the profusion of Linux in all different kinds of systems similarly necessitates different kinds of Linux. The Linux you’re going to run on a server that’s designed to be a data science workbench is going to be very different from the version of Linux running in your car or on your phone.</p>
<p>There are many different distributions (usually called “distros”) of Linux, for desktop, server, and other applications.</p>
<p>There are a few main distros you’re likely to run across on servers in your organization – Ubuntu, Red Hat Enterprise Linux (RHEL), Amazon Linux 2, and SUSE (<a href="https://www.youtube.com/watch?v=nLdexZlVkAY">pronunced soo-suh</a>).<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
</section>
<section id="a-tiny-intro-to-linux-administration" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="a-tiny-intro-to-linux-administration"><span class="header-section-number">8.2</span> A tiny intro to Linux administration</h2>
<p>Being a competent Linux admin is a career unto itself. So we’re not going to try to get you there in this chapter. Instead, the goal of this chapter is going to be to get you familiar with the basic tasks of interacting with a Linux server and the tools you need to at least get started working on one.</p>
<p>When you log into a Linux server, you’ll be interacting exclusively via the command line, so all of the commands in this chapter are going to be terminal commands. If you haven’t yet figured out how to open the terminal on your laptop and got it themed and customized so it’s perfect, I’d advise going back to <a href="#command-line">Chapter 2-2 on the command line</a>.</p>
<p>It’s also worth mentioning that if you’re using a Mac, many of these same tools and techniques will work out of the box and may be useful on your laptop. If you’re running Windows, you may have to look up the exact commands and syntax – but the general idea will hold.</p>
<p>In just a second, we’ll get into how to administer a Linux server, but let’s first talk about what are the main tasks of Linux administration:</p>
<ul>
<li><p><strong>Moving around</strong> <strong>and file operations</strong> A lot of the things you’ll do administering a server are just moving around, looking at different files, and interacting with them. We’ll spend some time on how to move around on the command line and how to interact with files.</p></li>
<li><p><strong>Managing who can do what</strong> In general, if you’re running a server, you’re going to be managing a number of different users on the server. Creating users and groups and managing them – specifically the things they’re allowed to do is a huge part of server administration, and we’ll go over what you’ll need to do and how.</p></li>
<li><p><strong>Managing resources</strong> As a server admin, especially in the cloud, you’ve got the ability to manage the resources – CPU, RAM, and memory – available to you. Keeping track of how much you’ve got of these things, how they’re being used, and making sure everyone is playing nice together with the shared resources is an important task.</p></li>
<li><p><strong>Networking</strong> Because your server is only valuable if you and others can connect to it, managing how your server can connect to the environment around it is an important part of Linux administration.</p></li>
</ul>
<p>Below, I’m intentionally mixing up bash commands and Linux system commands because they’re useful. If you know the difference and are pedantic enough to care, this list isn’t for you anyway.</p>
<p>The first thing that’s important to understand is that once you’ve SSH-ed into another server, your terminal is like a little window into that server. So everything that runs in the terminal is actually running on that other server and just bringing the results back to your eyes. But if you want to – for example – actually move a file from place to place, you’ll need to do something else.</p>
<p>Now we’ll get into some of these topics. Each section will introduce several concepts and the commands you can use to accomplish those things. I’ll include a table of the commands mentioned. At the end of the book, there’s a cheatsheet section that combines all of these commands.</p>
</section>
<section id="the-filesystem-files-and-editing-text" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="the-filesystem-files-and-editing-text"><span class="header-section-number">8.3</span> The filesystem, files, and editing text</h2>
<p>In the last chapter, you SSH-ed into your server using the <code>pem</code> key that was granted to you when you created the server. When you got there, you got dumped into the command line. So the first step is understanding where you are and how to go elsewhere.</p>
<p>The first thing to understand in Linux is that commands always happen <em>in a particular</em> <em>place</em> – called the working directory – and <em>as a particular user</em>. Depending on who you are and where you are, the commands you’re allowed to run and what happens when you do so might be different. It’s worth noting that this is also true on your laptop, but the experience of clicking on and using apps obfuscates the fact that this is happening under the hood.</p>
<p>When you land using the <code>pem</code> key, you’ve logged in as the root user and you’re at the file path root.</p>
<p>At any time, you can get the path where you’re sitting with the <code>pwd</code> command, which is an abbreviation for <em>print working directory</em>.</p>
<p>On a Linux server, you can think of the entire file system as a tree (for me an upside-down tree resonates more, since we generally talk about going “down” the tree to get to branches). The root of this tree is at <code>/</code>, and every file, folder, directory, and app is somewhere down the tree from <code>/</code>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you’re a Windows person, you might think this is analogous to <code>C:</code> – it is, but only sorta.</p>
<p>You’re right that the root of your drive is at <code>C:</code> and other things are descended from there.</p>
<p>Unlike in Linux, in Windows you can have multiple roots, one for each physical or logical disk you’ve got. That’s why your machine may have a <code>D:</code> drive, or if you have network shares, those will often be on <code>M:</code> or <code>N:</code> or <code>P:</code>, each with its own sub-tree.</p>
<p>In Linux, <em>everything</em> is a subtree below <code>/</code>, and it has nothing to do with the drives that house each of them. If you do have extra drives mounted to your Linux server, <code>/mnt</code> (short for mount) is a popular place to put them.</p>
</div>
</div>
<p>In addition to being the root of the file tree, <code>/</code> is used to separate directories and files, so for example <code>/opt/R</code> is the directory (or file) called R inside the <code>opt</code> directory, which is inside <code>/</code>.</p>
<p>Whenever you’re locating a directory or file, you can do so using either <em>absolute</em> or <em>relative</em> file paths. An absolute file path is the location of a file relative to the file root, <code>/</code>, while a relative file path is the path relative to the spot where you are right now.</p>
<p>When you’re writing out a file path, you can also explicitly access the working directory using <code>.</code>. In the last chapter, we talked about the <code>ls</code> command, which lists what’s in the working directory. Now, you understand that <code>ls</code> just has a default argument of <code>.</code>, so <code>ls</code> and <code>ls .</code> do exactly the same thing.</p>
<p>So an absolute (sometime called fully-qualified) path always starts with <code>/</code> and might look something like <code>/home/alex/</code>. So regardless of what your working directory is, <code>ls /home/alex</code> will always show the contents of <code>/home/alex</code>.</p>
<p>A relative path starts from your working directory. So I can run <code>ls alex</code>, and that will look for a directory named <code>alex</code> on the next rung down the tree from where I am and list its contents, if it exists. So if I’m in <code>/home</code>, <code>ls alex</code> will return the same thing as <code>ls /home/alex</code>, but otherwise it will return something else.</p>
<p>If you ever want to explicitly indicate your working directory in a file path, you can do so with <code>.</code>, so <code>ls ./alex</code> is the same as <code>ls alex</code>.</p>
<p>Sometimes absolute file paths make more sense, and sometimes relative paths do. In general, absolute file paths make more sense when you want to access the exact same resource from multiple places, and relative file paths make more sense when you want to access the same resource that might exist in different places.</p>
<p>Once you’ve looked around, you’ll have to move somewhere – you can change your working directory with the <code>cd</code> command, short for change directory.</p>
<p>There are a few directories with special names, aside from the root <code>/</code>. Your current working directory is always at <code>.</code>, and the parent of your current directory is at <code>..</code>, so you can move to the parent of your current directory using <code>cd ..</code> and up two levels with <code>cd ../..</code>.</p>
<p>We’ll get more into users below, but if your user has a home directory, that home directory is at <code>~</code>.</p>

<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>
<p>
Command
</p>
</th>
<th>
<p>
What it does/is
</p>
</th>
<th>
<p>
Helpful options
</p>
</th>
<th>
<p>
Example
</p>
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>
<p>
<code>/</code>
</p>
</td>
<td>
<p>
system root
</p>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr class="even">
<td>
<p>
<code>.</code>
</p>
</td>
<td>
<p>
current working directory
</p>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr class="odd">
<td>
<p>
<code>ls</code>
</p>
</td>
<td>
<p>
<strong>l</strong>i<strong>s</strong>t objects in a directory
</p>
</td>
<td>
<p>
<code>-l</code> - format as <strong>l</strong>ist
</p>
<p>
<code>-a</code> - <strong>a</strong>ll (include hidden files)
</p>
</td>
<td>
<p>
<code>$ ls .</code>
</p>
<p>
<code>$ ls -la</code>
</p>
</td>
</tr>
<tr class="even">
<td>
<p>
<code>pwd</code>
</p>
</td>
<td>
<p>
<strong>p</strong>rints <strong>w</strong>orking <strong>d</strong>irectory
</p>
</td>
<td>
</td>
<td>
<p>
<code>$ pwd</code>
</p>
</td>
</tr>
<tr class="odd">
<td>
<p>
<code>cd</code>
</p>
</td>
<td>
<p>
<strong>c</strong>hange <strong>d</strong>irectory
</p>
</td>
<td>
</td>
<td>
<p>
<code>$ cd ~/Documents</code>
</p>
</td>
</tr>
<tr class="even">
<td>
<p>
<code>~</code>
</p>
</td>
<td>
<p>
home directory of the current user
</p>
</td>
<td>
</td>
<td>
<p>
<code>$ ls ~</code>
</p>
</td>
</tr>
</tbody>

</table>
<section id="reading-text-files" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="reading-text-files"><span class="header-section-number">8.3.1</span> Reading text files</h3>
<p>On a Linux system, almost everything is either a text file or an executable. That means that configuration files and logs are just text files, and so you can interact with them all the same way.</p>
<p>A very common pattern in Linux administration is to read a log file to look for errors or clues, adjust a configuration setting as a result, and then restart a process.</p>
<p>You’ll find that your skills in understanding the Linux file tree, moving around, and seeing what’s in directories will be very helpful in getting to the files. Once you’re there, it’ll be useful to know how to actually interact with files.</p>
<p>Probably the commands you’ll use most often will be <code>cat</code> and <code>tail</code>. <code>cat</code> is the command to print a file, starting at the beginning. It’s often helpful to read through text files. Sometimes you’ve got a really big file and you want to see the first few rows (especially useful if it’s a csv). In that case, <code>less</code> can be handy because it opens large files much faster.</p>
<p><code>tail</code> skips right to the <em>end</em> of a file. This is most useful when you’re reading log files where the newest information is at the end. Log files usually are written so the newest part is <em>last</em>. So much so that tailing a log file is a synonym for looking at it.</p>
<p>If you want to get a live view of a log file that will update as more is written, use the <code>-f</code> flag (for <em>follow</em>).</p>
<p>If you’ve used regex, you’ll be familiar with the power of <code>grep</code> – a tool for using regex search. <code>grep</code> searches for and returns results that match the pattern you specify. Using <code>grep</code> well requires being quite proficient in regex, so I usually just use it for simple searches.</p>
<p>The true power of <code>grep</code> is unlocked in combination with the pipe. In Linux, the pipe operator – <code>|</code> – takes the output of the previous command and sends it into the next one. This kind of work will be very familiar to anyone who’s used the tidyverse in R, which was directly inspired by the Linux pipe.</p>
<p>So, for example, a combination I do all the time is to pipe the output of <code>ls</code> into <code>grep</code> when searching for a file inside a directory. So if I was searching for a file that contained the word <code>data</code> somewhere in the filename inside a specific project directory, that might look something like <code>ls ~/projects/my-project | grep data</code>.</p>

<table class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>
<p>
Command
</p>
</th>
<th>
<p>
What it does
</p>
</th>
<th>
<p>
Notes + Helpful options
</p>
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>
<p>
<code>cat</code>
</p>
</td>
<td>
<p>
Prints a file.
</p>
</td>
<td>
</td>
</tr>
<tr class="even">
<td>
<p>
<code>less</code>
</p>
</td>
<td>
<p>
Prints a file, but just a little.
</p>
</td>
<td>
<p>
Can be very helpful to look at a few rows of csv.
</p>
<p>
Only reads what youre looking at, so can be <em>much</em> faster than <code>cat</code> for big files.
</p>
</td>
</tr>
<tr class="odd">
<td>
<p>
<code>tail</code>
</p>
</td>
<td>
<p>
Look at the end of a file.
</p>
</td>
<td>
<p>
Log files usually are written so the newest part is <em>last</em>. So much so that tailing a log file is a synonym for looking at it.
</p>
<p>
If you want to get a live view of a log file that will update as more is written, use the <code>-f</code> flag (for <em>follow</em>).
</p>
</td>
</tr>
<tr class="even">
<td>
<p>
<code>grep</code>
</p>
</td>
<td>
<p>
Search a file using regex.
</p>
</td>
<td>
<p>
Useful to search inside a file, but youve gotta write regex. I suggest testing expressions on regex101.com.
</p>
<p>
Often useful in combination with the pipe.
</p>
</td>
</tr>
<tr class="odd">
<td>
<p>
<code>|</code>
</p>
</td>
<td>
<p>
the pipe
</p>
</td>
<td>
</td>
</tr>
</tbody>

</table>
</section>
<section id="deleting-and-moving-files" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="deleting-and-moving-files"><span class="header-section-number">8.3.2</span> Deleting and Moving Files</h3>
<p>There will be times when you have to copy, move, or remove files – each of these things can be accomplished with commands that are similarly abbreviated forms of the relevant words – <code>cp</code>, <code>mv</code>, and <code>rm</code>.</p>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Be very careful with the <code>rm</code> command.</p>
<p>Unlike on your desktop there’s no recycle bin! Things that are deleted are instantly deleted forever.</p>
</div>
</div>
<p>If you want to copy, move, or remove files, the <code>-r</code> flag for <code>recursive</code> is a handy one – if you try to copy, move or remove a directory, you often mean to act on the entire subtree below that directory, which the <code>-r</code> flag indicates.</p>
<p>Similarly, sometimes you want to list everything in a directory. For example, you might want to copy the entire contents of a directory. In that case, the wildcard, <code>*</code>, returns everything in a directory. So <code>cp alex/* alex2</code> copies the full contents of <code>alex</code> into <code>alex2</code>.</p>
<p>There are times when you want to make files or directories with nothing in them – the <code>touch</code> command makes a blank file at the specified file path, and <code>mkdir</code> makes a directory at the specified filepath. <code>mkdir</code> can be a little finicky about when paths exist and it will only make one level. So <code>mkdir my_dir</code> works, but <code>mkdir my_dir/my_sub_dir</code> does not. Using <code>mkdir -p</code>, it will use existing paths and make whichever parts of the path don’t yet exist.</p>

<table class="table">
<colgroup>
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 29%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>
<p>
Command
</p>
</th>
<th>
<p>
What it does/is
</p>
</th>
<th>
<p>
Helpful options + Notes
</p>
</th>
<th>
<p>
Example
</p>
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>
<p>
<code>rm</code>
</p>
</td>
<td>
<p>
<strong>r</strong>e<strong>m</strong>ove delete permanently!
</p>
</td>
<td>
<p>
<code>-r</code> - recursively a directory and included files
</p>
<p>
<code>-f</code> - force - dont ask for each file
</p>
</td>
<td>
<p>
<code>$ rm old_doc</code>
</p>
<p>
<code>r m -rf old_docs/</code>
</p>
<p>
BE VERY CAREFUL WITH <code>-rf</code>
</p>
</td>
</tr>
<tr class="even">
<td>
<p>
<code>cp</code>
</p>
</td>
<td>
<p>
<strong>c</strong>o<strong>p</strong>y
</p>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr class="odd">
<td>
<p>
<code>mv</code>
</p>
</td>
<td>
<p>
<strong>m</strong>o<strong>v</strong>e
</p>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr class="even">
<td>
<p>
<code>*</code>
</p>
</td>
<td>
<p>
wildcard
</p>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr class="odd">
<td>
<p>
<code>mkdir</code>
</p>
</td>
<td>
<p>
<strong>m</strong>a<strong>k</strong>e <strong>dir</strong>ectory
</p>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr class="even">
<td>
<p>
<code>touch</code>
</p>
</td>
<td>
<p>
update files timestamp to current time
</p>
</td>
<td>
<p>
Creates file if doesnt already exist.
</p>
</td>
<td>
</td>
</tr>
</tbody>

</table>
</section>
<section id="moving-things-to-and-from-the-server" class="level3" data-number="8.3.3">
<h3 data-number="8.3.3" class="anchored" data-anchor-id="moving-things-to-and-from-the-server"><span class="header-section-number">8.3.3</span> Moving things to and from the server</h3>
<p>One thing that’s likely to come up almost immediately when you’re working on your server is how to move files to and from the server. There are two main tools you’ll use for this task. The first is the <code>tar</code> command, which allows you to turn a set of files or whole directory into an archive. This is really handy because then moving a whole set of files turns into just moving one archive file. It also does some amount of file compression when it creates the archive file.</p>
<p>Annoyingly, the <code>tar</code> command does <em>both</em> archive creation and extraction, and is almost always used with several other flags. I never remember them – this is a command I google 100% of the time I use it.</p>
<p>Once you’ve created an archive file, you’ve got to move it. The <code>scp</code> command is the way to do this. <code>scp</code> – short for <strong>s</strong>ecure <strong>c</strong>o<strong>p</strong>y – is basically a combo of SSH and copy. So you will sometimes use ssh flags like <code>-i</code> to specify a particular SSH key, and you’ll also have to specify file paths.</p>
<p>One thing to remember about <code>scp</code> is that it makes an SSH connection at your request. This means that the other side of the connection needs to be available to receive an inbound request to connect over SSH. This is probably true of your server, but is almost never true of your laptop. So that means that when you’re getting things <em>to</em> or <em>from</em> your server you’ll almost always run the <code>scp</code> command from your laptop’s terminal, not from a terminal that’s already SSH-ed into the server.</p>

<table class="table">
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th>
<p>
Command
</p>
</th>
<th>
<p>
What it does
</p>
</th>
<th>
<p>
Notes + Helpful options
</p>
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>
<p>
<code>tar</code>
</p>
</td>
<td>
<p>
compress/decompress file/directory
</p>
</td>
<td>
<p>
Almost always used with flags that youll have to google.
</p>
<p>
Create is usually
</p>
<p>
<code>tar -czf &lt;archive name&gt; &lt;file(s)&gt;</code>
</p>
<p>
Extract is usually
</p>
<p>
<code>tar -xfv &lt;archive name&gt;</code>
</p>
</td>
</tr>
<tr class="even">
<td>
<p>
<code>scp</code>
</p>
</td>
<td>
</td>
<td>
</td>
</tr>
</tbody>

</table>
</section>
<section id="writing-files---a-rough-intro-to-vim" class="level3" data-number="8.3.4">
<h3 data-number="8.3.4" class="anchored" data-anchor-id="writing-files---a-rough-intro-to-vim"><span class="header-section-number">8.3.4</span> Writing files - a rough intro to <code>vim</code></h3>
<p>There will be many situations where writing into a text file will be handy while administering your server – for example, when changing config files. When you’re on the command line, you’ll use a command line tool for writing into those files – meaning you’ll navigate inside the file and do file operations completely from the keyboard. No mouse or touchpad!</p>
<p>There are two main tools you’ll probably encounter, <code>nano</code> and <code>vi</code>/<code>vim</code>.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>You can open a file in either by typing <code>nano &lt;filename&gt;</code> or <code>vi &lt;filename&gt;</code>. Once there you’ll be looking at a text file.</p>
<p>Both <code>nano</code> and <code>vim</code> offer extremely powerful text editing tools. It might be worth it for you to spend some time really getting comfortable in one! In this book, we’re just going to talk about the absolute minimum you’ll need to do to avoid getting stuck. Getting stuck in <code>nano</code> or <code>vim</code> is an extremely common situation for a newbie Linux admin. Hopefully once you’ve read this, you’ll at least avoid getting stuck in an editor with no way out.</p>
<p>In <code>nano</code> there will be helpful prompts along the bottom to tell you how to interact with the file, so you’ll see once you’re ready to go, you can exit with <code>^x</code>. But what is <code>^</code>? Pressing that key doesn’t seem to have any effect. The <code>^</code> caret is short for your control or command key – depending on whether you’re using a Mac or Windows keyboard. Phew!</p>
<p>Where <code>nano</code> gives you helpful hints, <code>vim</code> leaves you all on your own. It doesn’t even tell you you’re inside <code>vim</code>! This is where many people get stuck and end up having to just exit and start a new terminal session. It’s not the end of the world if you do, but a few simple <code>vim</code> commands can help you avoid that fate.</p>
<p>One of the most confusing things about <code>vim</code> is that you can’t edit the file when you first enter. That’s because <code>vim</code> keybindings were (1) developed in a time before all keyboards had arrow keys and (2) were designed to never make you take your hands off the center of the keyboard. When you enter, you’re in “normal” mode in which you can’t actually type anything!</p>
<p>By pressing <code>i</code>, you can enter <strong>i</strong>nsert mode – or “the mode where you can actually type stuff”. These days, almost all keyboard have arrow keys and you can navigate using the arrow keys in insert mode.</p>
<p>Once you’re done writing stuff, you can exit to normal mode by pressing the <code>escape</code> key. Once you’re in normal mode, you can do file operations by prefixing commands with a colon <code>:</code>. The two most common commands you’ll use are save (<strong>w</strong>rite) and <strong>q</strong>uit. You can combine these together, so you can save and quit in one command using <code>:wq</code>.</p>
<p>Sometimes you may find yourself inside a file having made changes you want to discard. If you try to exit with <code>:q</code>, you’ll again find yourself trapped in and endless loop of warnings that your changes won’t be saved unable to exit. You can tell <code>vim</code> you mean it with the exclamation mark and exit using <code>:q!</code>.</p>
<table class="table">
<colgroup>
<col style="width: 27%">
<col style="width: 27%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>What it does</th>
<th>Notes + Helpful options</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>^</code></td>
<td>Prefix for file command in <code>nano</code> editor.</td>
<td>Use the command or control key.</td>
</tr>
<tr class="even">
<td><code>i</code></td>
<td>Enter <strong>i</strong>nsert mode in <code>vim</code></td>
<td></td>
</tr>
<tr class="odd">
<td><code>escape</code></td>
<td>Enter normal mode in <code>vim</code>.</td>
<td></td>
</tr>
<tr class="even">
<td><code>:w</code></td>
<td><strong>W</strong>rite the current file in <code>vim</code> (in normal mode)</td>
<td>Can be combined to save and quit in one, <code>:wq</code></td>
</tr>
<tr class="odd">
<td><code>:q</code></td>
<td><strong>Q</strong>uit <code>vim</code> (in normal mode)</td>
<td><code>:q!</code> quit without saving</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="managing-who-can-do-what" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="managing-who-can-do-what"><span class="header-section-number">8.4</span> Managing who can do what</h2>
<p>Whenever you’re doing something in Linux, you’re doing that thing <em>as</em> a particular user. An important distinction about Linux users is that they may or may not correspond to an actual human.</p>
<p>In a minute, we’ll create users on your workbench server. These will correspond to actual humans who will use the servers, and they’ll have usernames, passwords, and home directories. But there are many more users than that on a Linux server. On most servers, there will be many <em>service accounts</em>, accounts that represent a particular service but don’t have a password or a home directory. They basically just exist to be holders for permissions.</p>
<p>For example, if you install RStudio Server on your server, there will be a user created called <code>rstudio-server</code>. So, for example, if you go to login to the server, it’s the <code>rstudio-server</code> user who needs permissions to do the relevant mechanics to get you in, like check that you’re a valid user on the system.</p>
<p>A group is a collection of users for the purpose of managing permissions group-wide. Each user has exactly one <em>primary</em> group, and can be a member of zero or more secondary groups.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> By default, each user has their own primary group of the same name as their username.</p>
<p>There’s also an administrative, root, or super user. When you logged in to your server using the <code>pem</code> key, you were logged in as the <code>root</code> user. This is a very dangerous practice, and you should basically never do it, except when you’ve just stood up a fresh server.</p>
<p>Instead, you’ll want to create a user on the system using the <code>adduser</code> command, log in as that actual user, and adopt super user privileges to run particular commands by prefixing them with <code>sudo</code>.</p>
<p>If you think back a little, this is one of the most common reasons for being in a file, having made edits, and being unable to exit. Your user very well may have read privileges, but not write. So you could get in and muck around, but when you went to save, you can’t! Exiting with <code>:q!</code> and reopening with <code>sudo vim</code> is your best bet.</p>
<p>You can change your user’s password at any time with <code>passwd</code> and you can check the user you are with <code>whoami</code> or <code>id</code>.</p>
<table class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 27%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>What it does</th>
<th>Helpful options</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sudo</code></td>
<td>Adopt super user permissions.</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>su &lt;username&gt;</code></td>
<td>Change to be a different user.</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>whoami</code> / <code>id</code></td>
<td>Check the current user.</td>
<td><code>id</code> gives more information, but is less catchy.</td>
<td></td>
</tr>
<tr class="even">
<td><code>passwd</code></td>
<td>Change password.</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>useradd</code></td>
<td>Add a new user.</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<section id="file-permissions" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="file-permissions"><span class="header-section-number">8.4.1</span> File Permissions</h3>
<p>Every object in Linux is just a file. Every log – file. Every picture – file. Every program – file. So with a pretty simple set of permissions, you can assign what everyone on the system is allowed to do.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The question of who’s allowed to do what – authorization – is an extremely deep one. There’s a chapter all about authorization, how it differs from authentication, and the different ways your IT/Admins might want to manage it <a href="sec3/3-3auth">later in the book</a>.</p>
<p>This is just going to be a high-level overview of basic Linux authorization.</p>
</div>
</div>
<p>There are three permissions in Linux: read, write, and execute. For some files execute doesn’t really make sense - what would it mean to execute a csv file? But Linux doesn’t care – you can assign any combination of these three permissions for any file.</p>
<p>Now, how are these permissions assigned?</p>
<p>Each file in Linux belongs to a user and a group. So for each file, read, write, and execute permissions can be set for the user who owns it, the group it belongs to, and everyone else.</p>
<p>To understand better, let’s look at the actual permissions on a file.</p>
<p>If you run <code>ls -l</code> on a directory, you get the list of the files – and the first few columns give you all the information you need to know about the file’s permissions.</p>
<p>So, for example, here’s a few lines of the output of running <code>ls -l</code> on a python project I’ve got.</p>
<pre><code>❯ ls -l                                                           
-rw-r--r--  1 alexkgold  staff     28 Oct 30 11:05 config.py
-rw-r--r--  1 alexkgold  staff   2330 May  8  2017 credentials.json
-rw-r--r--  1 alexkgold  staff   1083 May  8  2017 main.py
drwxr-xr-x 33 alexkgold  staff   1056 May 24 13:08 tests</code></pre>
<p>The first character indicates the type of file – <code>-</code> for normal and <code>d</code> for a directory.</p>
<p>The next 9 characters are indicators for the three permissions – <code>r</code> for read, a <code>w</code> for write, and a <code>x</code> for execute or <code>-</code> for not – first for the user, then the group, then any other user on the system.</p>
<p>So, for example, my <code>config.py</code> file with permissions of <code>rw-r-r--</code> indicates the user (<code>alexkgold</code>) can read and write the file, and everyone else – including in the file’s group <code>staff</code> – has read only.</p>
<p>In some cases, you may need to change a file’s permissions. You can do so using the <code>chmod</code> command. For <code>chmod</code>, you indicate permissions with the sum of numbers – 4 for read, 2 for write, and 1 for execute – one number for the user, group, and everyone else. So <code>chmod 765 &lt;filename&gt;</code> would give the user full permissions, read and write to the group, and read and execute to everyone else. This would be a strange set of permissions to give a file, but it’s a perfectly valid <code>chmod</code> command.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you spend any time administering a Linux server, you almost certainly will at some point finding yourself frustratedly applying <code>chmod 777</code> to a file to give full permissions to everyone.</p>
<p>I can’t in good faith tell you not to do this – we’ve all been there. But if it’s something important, be sure you change it back once you’re finished figuring out what’s going on.</p>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>What it does</th>
<th>Helpful options + notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>chmod &lt;permissions&gt; &lt;file&gt;</code></td>
<td>Modifies permissions on a file.</td>
<td>Number indicates permissions for user, group, others: add 4 for read, 2 for write, 1 for execute, 0 for nothing.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="managing-server-resources" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="managing-server-resources"><span class="header-section-number">8.5</span> Managing server resources</h2>
<p>Managing server resources is the third main activity you’ll need to do as a server admin. There are three resources you’ll need to manage – CPU, RAM, and storage space. More on all three of these and how to make sure you’ve got enough <a href="../../2-5-servers">later in this section</a>.</p>
<p>For now, we’re just going to go over how to check how much you’ve got, how much you’re using, and getting rid of stuff that’s misbehaving.</p>
<p>For many of these commands, the amount returned can be overwhelming, so you’ll usually use some sort of filtering mechanism. For many of these commands, that means you’ll run it, and send it into a pipe. On the other side of the pipe you might have <code>grep</code> to look for specific files or processes, or <code>head</code> or <code>tail</code> to get the first or last of them. If you want to specify how many, <code>head -n &lt;n&gt;</code> gives you the top <code>n</code> results.</p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>What it does</th>
<th>Helpful options</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>head</code></td>
<td>Returns the first results from a command.</td>
<td><code>-n &lt;n&gt;</code> to return the first <code>n</code> results.</td>
</tr>
</tbody>
</table>
<section id="managing-storage" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1" class="anchored" data-anchor-id="managing-storage"><span class="header-section-number">8.5.1</span> Managing storage</h3>
<p>If you’re running low on storage space, or think you might be, there are two things you might try to do – delete some stuff or add a bigger disk. There are two commands – <code>du</code> gives you the size of individual files inside a directory. This can be helpful for finding your largest files or directories if you think you might need to clean up things.</p>
<p><code>df</code> is the more IT/Admin way of thinking about storage usage – given a file or directory, what device is it mounted on and how full is that device? This can be really helpful if you’re thinking about swapping out for a bigger storage volume.</p>
<p>You’ll almost always use <code>du</code> and <code>df</code> with the <code>-h</code> flag, which puts the numbers in human-readable format.</p>

<table class="table">
<colgroup>
<col style="width: 22%">
<col style="width: 22%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th>
<p>
Command
</p>
</th>
<th>
<p>
What it does
</p>
</th>
<th>
<p>
Helpful options
</p>
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>
<p>
<code>du</code>
</p>
</td>
<td>
<p>
Check size of files.
</p>
</td>
<td>
<p>
Most likely to be used <code>du -h &lt;dir&gt; | head -n 10</code>
</p>
<p>
<code>du head -n 10</code>
</p>
</td>
</tr>
<tr class="even">
<td>
<p>
<code>df</code>
</p>
</td>
<td>
<p>
Check storage space on device.
</p>
</td>
<td>
<p>
-h
</p>
</td>
</tr>
</tbody>

</table>
</section>
<section id="running-processes" class="level3" data-number="8.5.2">
<h3 data-number="8.5.2" class="anchored" data-anchor-id="running-processes"><span class="header-section-number">8.5.2</span> Running processes</h3>
<p>Everything running on a computer is a process. So, for example, running a R session is (usually) one process. Some processes are more complex than others. For example, just running R or Python in your terminal and using the console is just a single process.</p>
<p>But more complex interactions, like running R inside RStudio or Python in Jupyter involves a number of different processes and subprocesses.</p>
<p>Each process has a numeric <strong>p</strong>rocess <strong>id</strong> or <code>pid</code> that can be useful for referring to them.</p>
<p>Sometimes these processes take up more than their share of RAM and CPU – the most relevant resources for running processes.</p>
<p>As an admin, you’ll occasionally have to track down rogue processes and shut them down. Shutting down a rogue process is pretty simple – you’ll use the <code>kill</code> command to kill processes once you’ve identified them. The trick is identifying the problematic ones.</p>
<p>Generally, if the system is doing something weird, <code>top</code> is a good first stop. <code>top</code> shows the processes consuming the most system resources in real time. It can help you find the processes that you might need to kill.</p>
<p>If you have a better idea of where troublesome processes might be, <code>ps aux</code> lists processes for all users.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> It’s common to pipe the output into <code>grep</code> to identify processes by names.</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>What it does</th>
<th>Helpful options</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>top</code></td>
<td>See what’s running on the system.</td>
<td></td>
</tr>
<tr class="even">
<td><code>ps aux</code></td>
<td>See all system processes.</td>
<td>The second column is the pid if you want to kill them.</td>
</tr>
<tr class="odd">
<td><code>kill</code></td>
<td>Kill a system process.</td>
<td><code>-9</code> to force kill</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="managing-networking" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="managing-networking"><span class="header-section-number">8.6</span> Managing networking</h2>
<p>The last thing you’ll have to manage on your Linux server is networking. After all, servers are only valuable to the degree they can serve people something! Very often, you’ll experience configuring something on your server, observing it working, and then not being able to get to it…without really understanding why.</p>
<p>In these cases, your first assumption should probably be that there’s an issue with the networking. In another section, we’ll get into the many places networking can be misconfigured, but the first thing to check is whether networking is the issue.</p>
<p><code>ping</code> and <code>curl</code> are useful tools for checking whether traffic can get into or out of your server. For example, if you’re on your server and struggling to install packages from CRAN or PyPi, a ping to the relevant URL can check whether your request is getting through to those servers at all.</p>
<p>On the flip side, if you can’t log into your server, a ping command from your laptop to your server is a good check of whether you’re correctly configured inbound networking.</p>
<p>Lastly, <code>netstat</code> is a useful command for checking which ports are being used on your machine. If you’ve got a service running, you need to make sure it’s available on a port – and that it’s the right port! <code>netstat</code> can help you check. For this purpose, <code>netstat</code> is most useful with the <code>-tlp</code> flags to show programs that are listening and the programs associated.</p>
<section id="practical-ssh" class="level3" data-number="8.6.1">
<h3 data-number="8.6.1" class="anchored" data-anchor-id="practical-ssh"><span class="header-section-number">8.6.1</span> Practical SSH</h3>
<p>Note that you don’t need to use <code>-i</code> assuming you’re using default SSH key name. If you wanted to use a different name, you can use <code>-i</code> to specify it, or you can set up an SSH config so your terminal knows which SSH key to use with which host.</p>
<p>By default, SSH always uses port 22. If for some reason you want to use a different port, you can use the <code>-p</code> flag with your SSH command.</p>
<p>SSH has one of the neatest debugging modes of any command. If you can’t connect via SSH for some reason, just add a <code>-v</code> to your command for <strong>v</strong>erbose mode. If that’s not enough information, add another v for <code>-vv</code>, and even another! Every <code>v</code> you add (up to 3) will make the output more verbose.</p>
<p>There’s one more SSH trick that can be useful – port forwarding, also called tunneling. SSH port forwarding allows you to take the output of a port on a remote server, route it through SSH, and display it <em>as if</em> it were on a local port. What this means, for example, is that you can connect to a server via SSH, and once you’ve set up port forwarding, you can access, for example, port 3939 on the remote server at <code>localhost:3939</code> from your laptop’s browser.</p>
<p>This can be helpful if you want to access a particular port on the remote server, but you haven’t yet set up public networking to it.</p>
<p>Port forwarding is, unfortunately, difficult to read and you’ll almost certainly have to google every time you use it unless you’re doing so on a daily basis.</p>
<p>For the kind of port forwarding you’ll use in debugging, you’ll use the <code>-L</code> flag. The syntax looks like this:</p>
<p><code>ssh &lt;local port&gt;:&lt;remote ip&gt;:&lt;remote port&gt; &lt;ssh hostname&gt;</code></p>
</section>
</section>
<section id="lab-setting-up-a-user-configuring-ssh-installing-r-python-and-more" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="lab-setting-up-a-user-configuring-ssh-installing-r-python-and-more"><span class="header-section-number">8.7</span> Lab: Setting up a user, configuring SSH, Installing R, Python, and More</h2>
<p>Now that you’ve SSH-ed into your server using the <code>pem</code> key, let’s make things more secure.</p>
<p>The first thing we’re going to do is create a user so that you can login without running as root all the time.</p>
<p>Let’s create a user using the <code>adduser</code> command. If you want to just walk along, let’s use the username <code>test-user</code>. Give the user a password when prompted to do so. Note that even though we’re logged in as the base <code>ubuntu</code> user, we’ll need to add <code>sudo</code> to do this command.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource {{bash}} number-lines code-with-copy"><code class="sourceCode"><span id="cb2-1"><a href="#cb2-1"></a>sudo adduser test-user</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let’s get started by just running <code>useradd</code>. This will walk us through a set of prompts to create a new user with a home directory and a password. Feel free to add any information you want – or to leave it blank – when prompted.</p>
<p>Now let’s give our new user the ability to use sudo as well with</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource {{bash}} number-lines code-with-copy"><code class="sourceCode"><span id="cb3-1"><a href="#cb3-1"></a>sudo usermod -aG sudo test-user</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you want to parse this command, we’re adding the user to the group <code>sudo</code>, which is how people are allowed to use the <code>sudo</code> command.</p>
<section id="creating-an-ssh-key-for-the-user" class="level3" data-number="8.7.1">
<h3 data-number="8.7.1" class="anchored" data-anchor-id="creating-an-ssh-key-for-the-user"><span class="header-section-number">8.7.1</span> Creating an SSH Key for the user</h3>
<p>Ok, now that we’ve got the user, let’s put an SSH key in place for them.</p>
<p>In order to be able to connect as a new user, we need to add the <em>public key</em> as an authorized key for this user. We do so by putting the public key into the user’s <code>.ssh/authorized_keys</code> directory.</p>
<p>If you’ve already got an SSH key you use, feel free to use that one. If you have to create one, there are plenty of walkthroughs on creating SSH keys available with a quick google search.</p>
<p>You’ll need to <code>scp</code> the public key to the server first.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<p>See if you can parse this command. Note that we have to specify that we’re using the <code>pem</code> key for the server, which file we’re copying, which user we’re connecting as, and where it’s going on the server.</p>
<p>Now our public key is up on the server. Let’s move it into place on the server. Here are the commands to do so</p>
<pre><code>ubuntu@ip-172-31-2-42:~$ sudo mv id_ed25519.pub /home/test-user/ #move to test-user
ubuntu@ip-172-31-2-42:~$ su test-user #change user
Password:
test-user@ip-172-31-2-42:/home/ubuntu$ cd ~ #go to home dir
test-user@ip-172-31-2-42:~$ mkdir .ssh #create .ssh directory
test-user@ip-172-31-2-42:~$ chmod 700 .ssh # Add appropriate permissions
test-user@ip-172-31-2-42:~$ cat id_ed25519.pub &gt; .ssh/authorized_keys #add public key to end of authorized_keys file
test-user@ip-172-31-2-42:~$ chmod 600 .ssh/authorized_keys #set permissions</code></pre>
<p>Now we’re all set up with SSH, and you can log in as a normal user from your laptop just using <code>ssh test-user@$SERVER_ADDRESS</code>.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you run into trouble assuming <code>sudo</code> with your new user, try exiting SSH and coming back. Sometimes these changes aren’t picked up until you restart the shell.</p>
</div>
</div>
<p>Now that we’re all set up, you should store the <code>pem</code> key somewhere safe and never use it to log in again.</p>
<p>If you ever want to exit SSH and get back to your machine, you can just type <code>exit</code>.</p>
</section>
<section id="getting-data-science-tools-running" class="level3" data-number="8.7.2">
<h3 data-number="8.7.2" class="anchored" data-anchor-id="getting-data-science-tools-running"><span class="header-section-number">8.7.2</span> Getting Data Science Tools Running</h3>
<p>Everything up to here has been preamble. We’ve been getting the right users into place and getting keys set up. Now starts the fun part – let’s get R, Python, RStudio Server, and Jupyter Lab configured on this server.</p>
<section id="installing-r" class="level4" data-number="8.7.2.1">
<h4 data-number="8.7.2.1" class="anchored" data-anchor-id="installing-r"><span class="header-section-number">8.7.2.1</span> Installing R</h4>
<p>There are at least four different ways to install R on your server. Feel free to choose the one you want:</p>
<ol type="1">
<li>Install from source</li>
<li>Install from apt-get</li>
<li>Install Posit compiled binaries - doesn’t work with RStudio-server, doesn’t search</li>
<li>Use <code>rig</code></li>
</ol>
<p>This Ubuntu server has a version of Python configured for system use, but we’re not going to want to use it for data science purposes, and it doesn’t have R, so let’s get them up and running.</p>
<p>There are a variety of different ways you can get R and Python running on this server. I am partial to installing the pre-compiled binaries Posit (formerly RStudio) makes available. These are minimal installs of just the base languages, allowing you to be more flexible later on.</p>
<p>If you want a challenge, feel free to try installing R from source and compiling it on your server. If you went with a t2.micro, compiling could take a minute.</p>
<p>There are two basic ways to install software on a Linux server. The first is to install from a system package repository. Each Linux distro has a utility for installing, updating, and removing sytem packages. In Ubuntu, that utility is called <code>apt</code>. Whenever you go to install a new system package, you’ll almost always run an update first. The <code>update</code> command checks the various package mirrors so that your system knows what the currently available packages are when you go to install them.</p>
<pre><code>sudo apt-get update</code></pre>
<p>The second is to manually download packages and install them on the system. We’re going to do a mixture of both.</p>
<p>There are a few different ways you can install R on your system. I’d recommend following the instructions on the Posit (formerly RStudio) website for installing R on a server.</p>
<p>For the simplest R install experience, use rig.</p>
</section>
</section>
<section id="installing-rstudio-server" class="level3" data-number="8.7.3">
<h3 data-number="8.7.3" class="anchored" data-anchor-id="installing-rstudio-server"><span class="header-section-number">8.7.3</span> Installing RStudio Server</h3>
<p>Directions are here: https://posit.co/download/rstudio-server/</p>
<p>Once you’ve installed, check status with <code>sudo systemctl status rstudio-server</code>.</p>
<p>SSH tunnel in with <code>ssh -L 8787:localhost:8787 test-user@$SERVER_ADDRESS</code></p>
<p>Note that this starts a tunnel in the foreground. You can do it in the background, but then you need to find again, which is a pain.</p>
<p>Access RStudio Server using laptop browser at localhost:8787, use username <code>test-user</code> and password you set on the server. Because you’re port forwarding, the browser on your laptop is actually connected to your server, but via SSH. We’ll configure to connect directly without SSH in <a href="2-4-understanding-traffic.html">Chapter&nbsp;<span>9</span></a>.</p>
<p>RStudio Server runs as a system process – R also needs to be installed.</p>
</section>
<section id="installing-jupyerhub-jupyterlab" class="level3" data-number="8.7.4">
<h3 data-number="8.7.4" class="anchored" data-anchor-id="installing-jupyerhub-jupyterlab"><span class="header-section-number">8.7.4</span> Installing JupyerHub + JupyterLab</h3>
<p>While RStudio uses R as it is running, you don’t need to configure anything in R for it to run. In contrast, JupyterHub and JupyterLab <em>are</em> Python programs, so we’re going to need to manage them in the context of a Python installation.</p>
<p>By default, our server came with a python install, but it’s very barebones (e.g.&nbsp;no pip). In order to avoid messing with the system python, we’re going to create a virtual environment for the purpose of installing and running JupyterHub.</p>
<pre><code>sudo su
apt install python3.10-venv
python3 -m venv /opt/jupyterhub
source /opt/jupyterhub/bin/activate</code></pre>
<p>Now that we’ve done that, let’s actually get JupyterHub itself installed and running. JupyterHub produces <a href="https://jupyterhub.readthedocs.io/en/stable/quickstart.html">docs that you can use</a> to get up and running very quickly. If you have to stop for any reason, make sure to come back, assume sudo, and start the JupyterHub virtual environment we created.</p>
<p>Here were the installation steps that worked for me:</p>
<pre><code>npm install -g configurable-http-proxy
apt-get install npm nodejs
python3 -m pip install jupyterhub jupyterlap notebook

ln -s /opt/jupyterhub/bin/jupyterhub-singleuser /usr/local/bin/jupyterhub-singleuser # symlink in singleuser server, necessary because we're using virtual environment

jupyterhub</code></pre>
<p>If all went well, you’ll now have JupyterHub up and running on port <code>8000</code>!</p>
<p>If you want to confirm, tunnel in with <code>ssh -L 8000:localhost:8000 test-user@$SERVER_ADDRESS</code>.</p>
</section>
<section id="running-as-a-service" class="level3" data-number="8.7.5">
<h3 data-number="8.7.5" class="anchored" data-anchor-id="running-as-a-service"><span class="header-section-number">8.7.5</span> Running as a service</h3>
<p>By default, RStudio runs as a system service (remember we started it with <code>systemctl</code>?). In contrast, JupyterHub runs as a Python process. This is ok, but it means that we’ve got to remember the command to start it if we have to restart it, and that it won’t auto restart if it were to fail for any reason.</p>
<p>A program that runs in the background on a machine, starting automatically, and controlled by <code>systemctl</code> is called a <em>daemon</em>. Luckily, it’s pretty easy to add JupyterHub as a system daemon to our server.</p>
<p>Let’s start by creating a config file for JupyterHub. JupyterHub has a default config file, but it’ll be easier to manage later if we create the config file now so we can edit it as needed.</p>
<p>You can create a config file using</p>
<pre><code>jupyterhub --generate-config</code></pre>
<p>Then, you should create a <code>/etc/jupyterhub</code> directory and move this file there. Later, when we start JupyterHub as a service, we’ll use this as the configuration, so if we want to change configuration later, there’s an easy way to do it.</p>
<p>There are basically two steps – create a file describing the service for the server’s daemon, and then start the service.</p>
<p>To start with, end the existing JupyterHub process. If you’ve still got that terminal open, you can do so with <code>ctrl</code> + <code>c</code>. If not, you can use your <code>ps aux</code> and <code>grep</code> skills to find and kill the JupyterHub processes.</p>
<p>On Ubuntu, adding a daemon file uses a tool called <code>systemd</code> and is really straightforward.</p>
<p>First, add this file to <code>/etc/systemd/system/jupyterhub.service</code>.</p>
<p>It should be pretty easy to parse. Two things to notice – the <code>Environment</code> line adds <code>/opt/jupyterhub/bin</code> to the path – that’s where our virtual environment is.</p>
<p>Second, the <code>ExecStart</code> line is the startup command. If you named your virtual environment something other than <code>jupyterhub</code>, you’ll have to change it in both these places.</p>
<p>Note the <code>-f /etc/jupyterhub/jupyterhub_config.py</code> – this is the command to start JupyterHub with the config we created a few seconds ago.</p>
<p>/etc/systemd/system/jupyterhub.service</p>
<pre><code>[Unit]
Description=Jupyterhub
After=syslog.target network.target

[Service]
User=root
Environment="PATH=/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/opt/jupyterhub/bin"
ExecStart=/opt/jupyterhub/bin/jupyterhub -f /etc/jupyterhub/jupyterhub_config.py

[Install]
WantedBy=multi-user.target</code></pre>
<p>Now we just need to reload the daemon tool so it picks up the new service it has available and start JupyterHub!</p>
<pre><code>systemctl daemon-reload
systemctl start jupyterhub</code></pre>
<p>You should now be able to see that JupyterHub is running using <code>systemctl status jupyterhub</code> and can see it again by tunneling to it.</p>
<p>If you want JupyterHub to automatically restart when the server restarts, you can run <code>systemctl enable jupyterhub</code>.</p>
</section>
</section>
<section id="comprehension-questions" class="level2" data-number="8.8">
<h2 data-number="8.8" class="anchored" data-anchor-id="comprehension-questions"><span class="header-section-number">8.8</span> Comprehension Questions</h2>
<ol type="1">
<li>Create a mind map of the following terms: Operating System, Windows, MacOS, Unix, Linux, Distro, Ubuntu</li>
<li>When you initially SSH-ed into your server using <code>ubuntu@$SERVER_ADDRESS</code>, what user were you and what directory did you enter? What about when you used <code>test_user@$SERVER_ADDRESS</code>?</li>
<li>What are the 3x3 options for Linux file permissions? How are they indicated in an <code>ls -l</code> command?</li>
<li>How would you do the following?
<ol type="1">
<li><p>Find and kill the process IDs for all running <code>rstudio-server</code> processes.</p></li>
<li><p>Figure out which port <code>JupyterHub</code> is running on.</p></li>
<li><p>Create a file called <code>secrets.txt</code>, open it with vim, write something in, close and save it, and make it so that only you can read it.</p></li>
</ol></li>
</ol>
<section id="questions-for-alex" class="level3" data-number="8.8.1">
<h3 data-number="8.8.1" class="anchored" data-anchor-id="questions-for-alex"><span class="header-section-number">8.8.1</span> Questions for Alex</h3>
<p>We didn’t actually make use of the EBS volume we mounted for home dirs. Should we do that? https://www.tecmint.com/move-home-directory-to-new-partition-disk-in-linux/</p>


</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>There are no Mac servers. There is a product called <em>Mac Server</em>, but it’s used to manage Mac desktops and iOS devices, not a real server.</p>
<p>There are also a few other operating systems that you’ll rarely encounter, like Oracle Solaris.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>People who are pedantic about operating systems or the history of computing will scream that the original release of Linux was just the operating system <em>kernel</em>, not a full operating system like Unix. I’ve noted it here to satisfy pedants, but it doesn’t matter much in practice.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>CentOS (short for Community ENTerprise Operating System) is an open source operating system maintained by Red Hat. Red Hat is changing the relationship between CentOS and RHEL and is discontinuing released of CentOS until 2024.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><code>vi</code> is the original fullscreen text editor for Linux. <code>vim</code> is its successor (<code>vim</code> stands for <code>vi</code> i<strong>m</strong>proved). For our purposes, they’re completely interchangeable.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Depending on your version of Linux, there <em>may</em> be a limit of 16 groups per user.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>This is another one where you’ll almost never use <code>ps</code> without <code>aux</code>.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Yes, you could just copy/paste the contents of your public key into the public key in the authorized_keys directory, but this is a good chance to practice using <code>scp</code>.</p>
<p>scp -i do4ds-lab-key.pem \ ~/.ssh/id_ed25519.pub \ #default name for ed25519 encrypted key ubuntu@ec2-54-159-134-39.compute-1.amazonaws.com:/home/ubuntu<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../chapters/sec2/2-2-cmd-line.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">The Command Line + SSH</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/sec2/2-4-understanding-traffic.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Computer Networks and the Internet</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2022, Alex K Gold</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/akgold/do4ds" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/alexkgold">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>