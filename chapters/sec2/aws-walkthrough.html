<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.339">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DevOps for Data Science - 8&nbsp; Lab 1: Get your own server</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<link href="../../chapters/sec2/understanding-traffic.html" rel="next">
<link href="../../chapters/sec2/servers.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Lab 1: Get your own server</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">DevOps for Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/akgold/do4ds" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/intro.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">DevOps Lessons for Data Science</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/cmd-line.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The Command Line + SSH</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/code-promotion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Code Promotion Workflows</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/repro-pkgs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Environments and Reproducibility</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/docker.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Docker for Data Science</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Taking Data to Production</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/cloud.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The Cloud and Cloud Providers</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Your Own Data Science Workbench</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/servers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Computers, Computing, and Servers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/aws-walkthrough.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Lab 1: Get your own server</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/understanding-traffic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Computer Networks and the Internet</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/using-urls.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Getting a real URL</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/private-network-config.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Private Networking Configuration</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Working with Enterprise IT</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/auth.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">How login works</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/offline.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Offline</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/scaling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Scaling</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Appendices</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/append/env-req.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Determining What You Need</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/append/terminal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Getting Started with Terminal</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/append/linux-cmd.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Useful Shell Commands</span></a>
  </div>
</li>
    </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#login-to-the-aws-console" id="toc-login-to-the-aws-console" class="nav-link active" data-scroll-target="#login-to-the-aws-console"> <span class="header-section-number">8.0.1</span> Login to the AWS Console</a></li>
  <li><a href="#stand-up-an-instance" id="toc-stand-up-an-instance" class="nav-link" data-scroll-target="#stand-up-an-instance"> <span class="header-section-number">8.0.2</span> Stand up an instance</a></li>
  <li><a href="#ssh-into-the-server" id="toc-ssh-into-the-server" class="nav-link" data-scroll-target="#ssh-into-the-server"> <span class="header-section-number">8.0.3</span> SSH into the server</a></li>
  <li><a href="#stand-up-nginx" id="toc-stand-up-nginx" class="nav-link" data-scroll-target="#stand-up-nginx"> <span class="header-section-number">8.0.4</span> Stand Up Nginx</a></li>
  <li><a href="#running-a-service-in-a-container" id="toc-running-a-service-in-a-container" class="nav-link" data-scroll-target="#running-a-service-in-a-container"> <span class="header-section-number">8.0.5</span> Running a service in a container</a></li>
  <li><a href="#burn-it-all-down" id="toc-burn-it-all-down" class="nav-link" data-scroll-target="#burn-it-all-down"> <span class="header-section-number">8.0.6</span> Burn it all down</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"> <span class="header-section-number">8.1</span> Exercises</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/akgold/do4ds/edit/main/chapters/sec2/aws-walkthrough.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Lab 1: Get your own server</span></h1>
</div>





<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>Throughout the rest of the book, we’re going to talk about how to set up a real data science workbench in the cloud. In this first lab, we’re just going to go through the simple steps of getting a free server from AWS to use.</p>
<p>If you’ve never set up a server before, I’d strongly recommend you play along.</p>
<p>Throughout the rest of the book, we’re going to be taking this toy server and upgrading it in various ways. If you’re trying to work along, you’ll probably do this a dozen times or more over the course of the book.</p>
<p>There are a number of topics that we’re going to gloss over in this chapter including networking and storage configuration, security, and how SSH works. By the time you’re done with this book, you’ll be able to come back to this chapter and fully understand everything you did.</p>
<p>You’ll also understand why this first server is ready for production data science work in the same way throwing a tarp over a tree branch in the forest is a house. It might be a nice place to stay for a little, but you’re going to need something more robust longer-term.</p>
<p>For now, you can get a server of your own in 10-15 minutes if you just follow along, which is what I recommend.</p>
<section id="login-to-the-aws-console" class="level3" data-number="8.0.1">
<h3 data-number="8.0.1" class="anchored" data-anchor-id="login-to-the-aws-console"><span class="header-section-number">8.0.1</span> Login to the AWS Console</h3>
<p>We’re going to be standing up a server on Amazon Web Services (AWS). If you feel comfortable, feel free to do this in any cloud provider. All cloud providers have their own equivalents of all the things we’re about to do in AWS.</p>
<p>We will be standing up a server in AWS’s <em>free tier</em> – so there will be no cost involved as long as you haven’t used up all your AWS free tier credits before now.</p>
<p>We’re going to start by logging into AWS. If you’ve done this before, just go ahead and log in.</p>
<p>If not, go to <a href="https://aws.amazon.com" class="uri">https://aws.amazon.com</a> and click <code>Sign In to the Console</code> .</p>
<p>If you’ve never set up an AWS account before, click <code>Create a New AWS account</code> and follow the instructions to create an account. Note that even if you’ve got an Amazon account for ordering stuff online and watching movies, an AWS account is separate.</p>
<p>Once you’ve logged in, you’ll be confronted by the AWS console. There are a ton of things here, and it’s rather overwhelming. If you feel like you have to understand what all these things are before going ahead, feel free to check out the chapter on The Cloud.</p>
</section>
<section id="stand-up-an-instance" class="level3" data-number="8.0.2">
<h3 data-number="8.0.2" class="anchored" data-anchor-id="stand-up-an-instance"><span class="header-section-number">8.0.2</span> Stand up an instance</h3>
<p>Click on the <code>EC2</code> service (it’s under <code>Launch a virtual machine</code> or <code>Compute</code> depending on where you landed). The table has all the different quick start Amazon Machine Images (AMIs). Find and click <code>Ubuntu Server 20.04 LTS</code> – it’ll be one of the first handful.</p>
<p>Now you’ll be seeing the instance size chooser. It should have auto-selected a server with the label <code>Free tier eligible</code>. Just stick with this for now.</p>
<p>Scroll down and click <code>Review and Launch</code>, and <code>Launch</code> on the next page.</p>
<p>When you click Launch, you’ll be asked to use a key pair. Assuming you don’t have an existing keypair, select <code>Create a new key pair</code>, name it <code>my_test_key</code>, and click <code>Download</code>.</p>
<p>Keep track of the <code>my_test_key.pem</code> file your computer downloads, you’ll need it again in a minute.</p>
<p>Click <code>Launch Instances</code>. AWS is now creating a virtual server <em>just for you</em>. If you click <code>View Instances</code> in the lower right, you’ll see your instance. When the instance state switches to <code>Running</code>, it’s up and running!</p>
<p>Before we leave the AWS console, let’s make sure that we’ll be able to get to it from the internet.</p>
<p>Scroll down to the Security tab. Click the blue link under <code>Security Groups</code>, which will start with <code>sg-</code> and include <code>launch-wizard-</code> in parentheses.</p>
<p>Click <code>Edit inbound rules</code> , then <code>Add rule</code>. Under <code>Type</code>, scroll down and select <code>HTTP</code>, and under <code>Source Type</code>, select <code>Anywhere-IPv4</code>. Scroll down and click <code>Save rules</code>.</p>
</section>
<section id="ssh-into-the-server" class="level3" data-number="8.0.3">
<h3 data-number="8.0.3" class="anchored" data-anchor-id="ssh-into-the-server"><span class="header-section-number">8.0.3</span> SSH into the server</h3>
<p>The <code>.pem</code> key you downloaded is the skeleton key to your server. If you were setting up a real server, you’d need to be extremely careful with this key, as it allows unrestricted access to the server. For the same reason, it’s also great for quickly monkeying around with a server.</p>
<p>Before we can use it to open the server, we’ll need to make a quick change to the permissions on the key.</p>
<p>To take the next steps, you’ll need to at least be able to open your computer’s terminal and copy/paste some commands below. If that’s new to you, feel free to check out the <a href="../sec1/cmd-line.html">chapter on using the command line</a>.</p>
<p>If you’re on a Mac or Linux system, you’ll do the following:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cd ~/Downloads <span class="co">#or whatever directory the key is in</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> chmod 600 my_test_key.pem</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>#TODO: Windows?</p>
<p>To access your server, click on the <code>Instance ID</code> link for your server, and copy the <code>Public IPv4 DNS</code>, which will start with <code>ec2-</code> and end with <code>amazonaws.com</code>.</p>
<p>In your terminal type the following</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> ssh <span class="at">-i</span> my_test_key.pem ubuntu@<span class="op">&lt;</span>Public IPv4 DNS you copied<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Type <code>yes</code> when prompted, and you’re now logged in to your server!</p>
</section>
<section id="stand-up-nginx" class="level3" data-number="8.0.4">
<h3 data-number="8.0.4" class="anchored" data-anchor-id="stand-up-nginx"><span class="header-section-number">8.0.4</span> Stand Up Nginx</h3>
<p>Before we log off and kill this server, let’s stand up Nginx.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Nginx is open source software that can be used to serve websites, as well as a variety of other networking tasks. You’ll see it again before you’re through this book.</p>
<p>Let’s get it installed with the commands below.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo apt update</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo apt-get install nginx <span class="at">-y</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Go back into the AWS console to the instance page and copy the <code>Public IPv4 DNS</code>. Paste this into your browser’s navigation bar, and add <code>http://</code> right before. When you navigate to the page, you’ll see the default Nginx home page.</p>
<p>Let’s make a quick change to the page, just for fun.</p>
<p>Back in your terminal that’s still <code>SSH</code>-ed into the instance, navigate to where that page is located:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cd /var/www/html</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can edit the page by typing</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo vi index.nginx-debian.html</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you don’t recall how to use <code>vi</code>, check out the <a href="">command line</a> tutorial, but for now, you can enter edit mode by pressing <code>i</code>, navigating around with the arrow keys, and typing.</p>
<p>Edit something – say change this line</p>
<pre><code>&lt;h1&gt;Welcome to nginx!&lt;/h1 &gt;</code></pre>
<p>to something a little more personalized.</p>
<p>When you’re done, hit <code>esc</code> followed by <code>:wq</code>.</p>
<p>Now, when you re-load the page in your browser, you should be able to see your changes reflected there.</p>
</section>
<section id="running-a-service-in-a-container" class="level3" data-number="8.0.5">
<h3 data-number="8.0.5" class="anchored" data-anchor-id="running-a-service-in-a-container"><span class="header-section-number">8.0.5</span> Running a service in a container</h3>
<p>Consider reviewing the <a href="#docker">containers</a> section if you’re not generally familiar with how to run a container.</p>
<p>If you want to run a service, like RStudio Server, out of a container, the pattern is very similar to running an interactive app. You’ll find an appropriate container, bring it up, and do some port mapping to make it available to the outside world.</p>
<p>The <a href="https://hub.docker.com/u/rocker">rocker</a> organization makes available a number of containers related to R and RStudio. So if you want a container running RStudio Server on your laptop, it’s as easy as running</p>
<pre><code>docker run \
  --rm -d \
  -p 8787:8787 \
  --name rstudio \
  rocker/rstudio</code></pre>
<p>Now, when you go to <code>http://localhost:8787</code> on your laptop, you should see the the RStudio login screen…but what’s the password? Luckily, the wonderful folks who built the <code>rocker/rstudio</code> container made it easy to supply a password for the default <code>rstudio</code> user.</p>
<p>We do this by supplying an environment variable to the container named <code>PASSWORD</code> using the <code>-e</code> flag.</p>
<p>So, <code>docker kill rstudio</code> and try again by adding a password when you start:</p>
<pre><code>docker run \
  --rm -d \
  -p 8787:8787 \
  --name rstudio \
  -e PASSWORD=my-rstudio-pass
  rocker/rstudio</code></pre>
<p>Now you should be looking at the RStudio IDE! Hurray!</p>
<p>This is great for standing up a quick sandbox…but before you go standing up an RStudio Server on your laptop and spreading it around the world, there are a few things you’ll want to think about.</p>
<p>It’s totally possible to run a service like RStudio Server in a docker container, but you’ll need to take all the same steps to make it available to the outside world in terms of hosting it on a server, routing traffic properly, and making sure that you’re using <code>HTTPS</code> to secure your traffic. See chapters XX-XX for more on all that.</p>
<p>Now, let’s say I wanted to create another user on the server (docker exec)</p>
<p>But there’s also one more concern that’s particular to Docker.</p>
<p>One of the best things about a Docker container is how ephemeral it is. Things come up in moments, and when they’re gone you don’t have to worry about them. But that’s also very dangerous if you want things to persist.</p>
<p>The best way to fix this is to mount in external volumes that will maintain the state should the container die or should you want to replace it. We went over how to do that in the last section.</p>
<p>At a minimum, you’ll want to mount in the user home directories that store all the data and code you can see in RStudio Server. You may also want to mount in other bits of state, like wherever you’ve installed your version of R, and the config file you’re using to maintain the server.</p>
<p>Note that unlike on a server, where you’ll restart the process of the server, the pattern with a container generally is to kill and restart the container, and let changes come up with the new container.</p>
</section>
<section id="burn-it-all-down" class="level3" data-number="8.0.6">
<h3 data-number="8.0.6" class="anchored" data-anchor-id="burn-it-all-down"><span class="header-section-number">8.0.6</span> Burn it all down</h3>
<p>One of the best things about cloud infrastructure is that it can go away as easily as it came up. We made a number of choices here that are fine for ephemeral infrastructure for playing around. But this server should not be used for anything real.</p>
<p>When you’ve had your fill of playing, let’s take the server down.</p>
<p>Go back to the EC2 page for your server. Under the <code>Instance State</code> drop down in the upper right, choose <code>Terminate Instance</code>. If you go to the <code>Instances</code> page, it’ll take just a minute for the instance to go away.</p>
</section>
<section id="exercises" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="exercises"><span class="header-section-number">8.1</span> Exercises</h2>
<p>Try standing up a new server and installing R and RStudio Server Open Source, or Python and JupyterHub.</p>
<ul>
<li><p>Hint 1: Remember that your instance only allows traffic to SSH in on port <code>22</code> by default. You access RStudio on port <code>8787</code> by default and JupyterHub on port <code>8000</code>. You control what ports are open via the Security Group.</p></li>
<li><p>Hint 2: You’ll need to create a user on the server. The <code>adduser</code> command is your friend.</p></li>
</ul>
<p>#TODO: test out JupyterHub</p>


</section>
<section class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1" role="doc-endnote"><p>I pronounce this word “engine-ex”, but there are numerous options for pronunciation. Pick your favorite.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../chapters/sec2/servers.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Computers, Computing, and Servers</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/sec2/understanding-traffic.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Computer Networks and the Internet</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2021, Alex K Gold</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/akgold/do4ds" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/alexkgold">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>