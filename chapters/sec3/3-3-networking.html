<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DevOps for Data Science - 12&nbsp; Intro to Computer Networks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/sec3/3-4-dns.html" rel="next">
<link href="../../chapters/sec3/3-2-linux-admin.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BTSMMRMH08"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-BTSMMRMH08', { 'anonymize_ip': true});
</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Intro to Computer Networks</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">DevOps for Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/akgold/do4ds" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Welcome!</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/intro.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/sec1/1-0-sec-intro.html" class="sidebar-item-text sidebar-link">DevOps Lessons for Data Science</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-1-code-promotion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Code promotion and integration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-2-env-as-code.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Environments as Code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-3-data-arch.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Pipeline Architecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-4-apis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Designing Your Application Layers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec1/1-5-monitor-log.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Logging and Monitoring</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/sec2/2-0-sec-intro.html" class="sidebar-item-text sidebar-link">IT/Admin Tools</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/2-1-terminal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The Terminal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/2-2-ssh.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Connecting Securely with SSH</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/2-3-cmd-line.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Getting comfortable on the Command Line</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec2/2-4-docker.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Demystifying Docker</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/sec3/3-0-sec-intro.html" class="sidebar-item-text sidebar-link">IT/Admin for Data Science</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-1-cloud.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Getting Started with the Cloud</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-2-linux-admin.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Basic Linux SysAdmin</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-3-networking.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Intro to Computer Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-4-dns.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">DNS allows for human-readable addresses</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-5-ssl.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">You should use SSL/HTTPS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec3/3-6-servers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Choosing the right server for you</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/sec4/4-0-sec-intro.html" class="sidebar-item-text sidebar-link">Making it Enterprise-Grade</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec4/4-1-os-ds-in-ent.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Open Source Data Science in the Enterprise</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec4/4-2-ent-networks.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Enterprise Networking</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec4/4-3-auth.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Auth in Enterprise</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/sec4/4-4-ent-servers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Enterprise Server Management</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/append/docker-cheatsheet.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Docker Cheatsheet</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/append/auth.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Auth Technologies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/append/lab-map.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Lab Map</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#tcpip-and-the-mail" id="toc-tcpip-and-the-mail" class="nav-link active" data-scroll-target="#tcpip-and-the-mail"><span class="toc-section-number">12.1</span>  TCP/IP and the mail</a></li>
  <li><a href="#ports-get-you-to-the-right-service" id="toc-ports-get-you-to-the-right-service" class="nav-link" data-scroll-target="#ports-get-you-to-the-right-service"><span class="toc-section-number">12.2</span>  Ports get you to the right service</a>
  <ul class="collapse">
  <li><a href="#special-port-cheatsheet" id="toc-special-port-cheatsheet" class="nav-link" data-scroll-target="#special-port-cheatsheet"><span class="toc-section-number">12.2.1</span>  Special Port Cheatsheet</a></li>
  </ul></li>
  <li><a href="#assigning-addresses" id="toc-assigning-addresses" class="nav-link" data-scroll-target="#assigning-addresses"><span class="toc-section-number">12.3</span>  Assigning addresses</a>
  <ul class="collapse">
  <li><a href="#firewalls-allow-lists-and-other-security-settings" id="toc-firewalls-allow-lists-and-other-security-settings" class="nav-link" data-scroll-target="#firewalls-allow-lists-and-other-security-settings"><span class="toc-section-number">12.3.1</span>  Firewalls, allow-lists, and other security settings</a></li>
  </ul></li>
  <li><a href="#how-packets-are-routed" id="toc-how-packets-are-routed" class="nav-link" data-scroll-target="#how-packets-are-routed"><span class="toc-section-number">12.4</span>  How packets are routed</a></li>
  <li><a href="#how-to-recognize-an-ip-address" id="toc-how-to-recognize-an-ip-address" class="nav-link" data-scroll-target="#how-to-recognize-an-ip-address"><span class="toc-section-number">12.5</span>  How to recognize an IP address</a>
  <ul class="collapse">
  <li><a href="#reserved-ip-addresses" id="toc-reserved-ip-addresses" class="nav-link" data-scroll-target="#reserved-ip-addresses"><span class="toc-section-number">12.5.1</span>  Reserved IP Addresses</a></li>
  </ul></li>
  <li><a href="#basic-network-troubleshooting" id="toc-basic-network-troubleshooting" class="nav-link" data-scroll-target="#basic-network-troubleshooting"><span class="toc-section-number">12.6</span>  Basic network troubleshooting</a></li>
  <li><a href="#comprehension-questions" id="toc-comprehension-questions" class="nav-link" data-scroll-target="#comprehension-questions"><span class="toc-section-number">12.7</span>  Comprehension Questions</a></li>
  <li><a href="#lab-making-it-accessible-in-one-place" id="toc-lab-making-it-accessible-in-one-place" class="nav-link" data-scroll-target="#lab-making-it-accessible-in-one-place"><span class="toc-section-number">12.8</span>  Lab: Making it accessible in one place</a>
  <ul class="collapse">
  <li><a href="#step-1-configure-nginx" id="toc-step-1-configure-nginx" class="nav-link" data-scroll-target="#step-1-configure-nginx"><span class="toc-section-number">12.8.1</span>  Step 1: Configure Nginx</a></li>
  <li><a href="#step-2-open-port-80" id="toc-step-2-open-port-80" class="nav-link" data-scroll-target="#step-2-open-port-80"><span class="toc-section-number">12.8.2</span>  Step 2: Open port 80</a></li>
  <li><a href="#step-3-configure-rstudio-server-and-jupyterhub-to-be-on-a-subpath" id="toc-step-3-configure-rstudio-server-and-jupyterhub-to-be-on-a-subpath" class="nav-link" data-scroll-target="#step-3-configure-rstudio-server-and-jupyterhub-to-be-on-a-subpath"><span class="toc-section-number">12.8.3</span>  Step 3: Configure RStudio Server and JupyterHub to be on a subpath</a></li>
  <li><a href="#step-4-try-it-out" id="toc-step-4-try-it-out" class="nav-link" data-scroll-target="#step-4-try-it-out"><span class="toc-section-number">12.8.4</span>  Step 4: Try it out!</a></li>
  <li><a href="#lab-extensions" id="toc-lab-extensions" class="nav-link" data-scroll-target="#lab-extensions"><span class="toc-section-number">12.8.5</span>  Lab Extensions</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/akgold/do4ds/edit/main/chapters/sec3/3-3-networking.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-basic-networks" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Intro to Computer Networks</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>These days using a computer is basically synonymous with using a computer network. When you visit a website, print a document, or login to your email, you are making use of a computer network.</p>
<p>This chapter is an introduction to how computer networks work. This chapter is heavy on introducing mental models for how network traffic works. There is no lab in this chapter.</p>
<p>The computer network we’re most familiar with is the biggest of them all: The Internet. But there are myriad other networks, like the very small private network of the devices (phones, computers, TVs, etc) connected to your home wifi router, to the somewhat larger VPN (which stands for virtual private network) you might connect to for school or work.</p>
<p>The good news is that computer networks are basically all the same. If you understand one, you understand them all. Each step in the process is governed by a <em>protocol</em> that defines what is valid.</p>
<p>There are two basic levels of protocols that are helpful to understand – the transport + address layer, and the application layer.</p>
<p>Just as you and your friend could communicate in any number of human languages, computers define what a valid message is with an <em>application layer protocol</em>.</p>
<p>There are numerous application layer protocols. Some you will see in this book include <code>SSH</code> for access to the terminal on a remote machine, <code>(S)FTP</code> for file transfers, <code>SMTP</code> for email, <code>LDAP(S)</code> for authentication and authorization, and <code>websockets</code> for persistent bi-directional communication, which is what the Shiny and Streamlit packages use.</p>
<p>The most common application layer protocol, used for all standard web traffic, is <strong>h</strong>yper<strong>t</strong>ext <strong>t</strong>ransfer <strong>p</strong>rotocol (<em>http</em>), which we discussed in some depth in <a href="../sec1/1-4-apis.html">Chapter&nbsp;<span>4</span></a> on using APIs for data science purposes.</p>
<p>For the purposes of this chapter, we’re going to completely set aside physical network infrastructure. Yes, there are wires, cables, satellites, routers, server farms, and more that allow computer networking to work. For the purposes of this chapter, we’re going to focus entirely on the software side of networking.</p>
<p>One cool thing about the cloud is that it allows you to abstract away all of the physical hardware and focus completely on how the software interacts.</p>
<section id="tcpip-and-the-mail" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="tcpip-and-the-mail"><span class="header-section-number">12.1</span> TCP/IP and the mail</h2>
<p>Let’s start by imagining you have a penpal, who lives in an apartment building across the country.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>Let’s say you’ve got some juicy gossip to share with your penpal. Because this gossip is so juicy, you’re not going to put it on a postcard. You’d write your letter, put it inside an envelope, address the letter to the right spot, and put it in the mail.</p>
<p>You trust the postal service to take your letter, deliver it to the correct address, and then your friend will be able to read your letter.</p>
<p>The process of actualy getting data from one computer to another is governed by the <em>TCP/IP</em> protocol and is called <em>packet switching</em>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>When a computer has data to send to another computer, it takes that information and packages it up into a bundle called a <em>packet</em>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>The data in the packet is like the contents of your letter.</p>
<p>Just as the postal service defines permissible envelope sizes and address formats, the <em>TCP/IP</em> protocol defines what a packet has to look like from the outside, including what constitutes a valid address.</p>
<p>A uniform resource locator (URL) is the way to address a specific resource on a network.</p>
<p>A full URL includes 4 pieces of information: <span class="math display">\[\overbrace{\text{https://}}^\text{protocol}\overbrace{\text{example.com}}^\text{address}\overbrace{\text{:443}}^\text{port}\overbrace{\text{/}}^\text{resource}\]</span></p>
<p>The protocol starts the URL. It is separated from the rest of the URL by <code>://</code>.</p>
<p>Each of the rest of the pieces of the URL is needed to get to a specific resource and has a real-world analog.</p>
<p>The address is like the street address of your penpal’s building. It specifies the host where your data should go.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>A host is any entity on a network that can receive requests and send responses. So a server is a common type of host on a network, but so is a router, your laptop, and a printer.</p>
<p>The port is like your friend’s apartment. It specifies which service on the server to address.</p>
<p>Lastly, the resource dictates what resource you want on the server. It’s like the name on the address of the letter, indicating that you’re writing to your penpal, not their mom or sister.</p>
<p>This full URL may look a little strange to you. You’re probably used to just putting a standalone domain like <span class="math inline">\(google.com\)</span> into your browser when you want to go to a website. That’s because <code>https</code>, port <code>443</code>, and <code>/</code> are all defaults, so modern browsers don’t make you specify them.</p>
<p>But what if you make it explicit? Try going to <code>https://google.com:443/</code>. What do you get?</p>
</section>
<section id="ports-get-you-to-the-right-service" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="ports-get-you-to-the-right-service"><span class="header-section-number">12.2</span> Ports get you to the right service</h2>
<p>A port is a location on a server where a network connection is possible. It’s like the apartment number for the mail. Each port has a unique number 1 to just over 65,000. By default, the overwhelming majority of the ports on the server are closed for security reasons.</p>
<p>Your computer automatically opens ports to make outgoing connections, but if you want to allow someone to make inbound connections – like to access RStudio or a Shiny app on a server – you need to manually configure and open a port.</p>
<p>Any program that is running on a server and that you intend to be accessible from the outside is called a service. For example, we set up RStudio, JupyterHub, and a Plumber API as services in the lab in <a href="3-2-linux-admin.html">Chapter&nbsp;<span>11</span></a>. Each service lives on a unique port on the server.</p>
<p>Since each service running on a server needs a unique port, it’s common to choose a somewhat random relatively high-numbered port. That makes sure it’s unlikely that the port will conflict with another service running on the server.</p>
<p>For example RStudio Server runs on port <code>8787</code> by default. According to JJ Allaire, there’s no special meaning to this port. It was chosen because it was easy to remember and not <code>8888</code>, which some other popular projects had taken.</p>
<section id="special-port-cheatsheet" class="level3" data-number="12.2.1">
<h3 data-number="12.2.1" class="anchored" data-anchor-id="special-port-cheatsheet"><span class="header-section-number">12.2.1</span> Special Port Cheatsheet</h3>
<p>All ports below 1024 are reserved for common server tasks, so you can’t assign services to low-numbered ports.</p>
<p>There are also three common ports that will come up over and over. These are handy because if you’re using the relevant service, you don’t have to indicate if it’s using the default port.</p>
<table class="table">
<thead>
<tr class="header">
<th>Protocol</th>
<th>Default Port</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>HTTP</td>
<td>80</td>
</tr>
<tr class="even">
<td>HTTPS</td>
<td>443</td>
</tr>
<tr class="odd">
<td>SSH</td>
<td>22</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="assigning-addresses" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="assigning-addresses"><span class="header-section-number">12.3</span> Assigning addresses</h2>
<p>The proper address of a server on a network is defined by the <em>Internet Protocol</em> (IP) and is called an <em>IP Address</em>. IP addresses are mapped to human-friendly domains like <span class="math inline">\(google.com\)</span> with the <em>Domain Name Service (DNS)</em>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this chapter, we’re going to set DNS aside and talk exclusively about IP Addresses.</p>
<p><a href="3-4-dns.html">Chapter&nbsp;<span>13</span></a> is all about DNS.</p>
</div>
</div>
<p>Every host on the internet has a public IP address.</p>
<p>A public IP address is an IP address that is valid across the entire internet. That means that each public IP address is unique across the entire internet. You can think of a public IP address like the public street address of a building.</p>
<p>But many hosts are not publicly accessible on the internet. Many are housed in private networks. A private network is one where the hosts aren’t directly accessible to the public. You can think of a host in a private network like a building inside a gated community. You may still be able to get there from the public, but you can’t just walk up to the building from the street. Instead you need to come in through the specific gates that have been permitted and approach only on the roads that are allowed.</p>
<p>TODO: Image of public IPs like street address, private like cul-de-sac</p>
<p>There are many different kinds of private networks. Some are small and enforced by connection to a physical endpoint, like the private network your WiFi router controls that houses your laptop, phone, TV, Xbox, and anything else you allow to connect to your router. In other cases, the network is a software network. Many organizations have virtual private networks (VPNs). In this case, you connect to the network via software. There may be resources you can only connect to inside your VPN and there also might be limitations about what you can go out and get.</p>
<p>There are a few different reasons for this public/private network split. The first is security. If you’ve got a public IP address, anyone on the internet can come knock on your virtual front door. That’s actually not so bad. What’s more problematic is that they can go all the way around the building looking for an unlocked side door. Putting your host inside a private network is a way to ensure that people can only approach the host through on the pathways you intend.</p>
<p>The second reason is convenience.</p>
<p>Private networks provide a nice layer of abstraction for network addresses.</p>
<p>You probably have a variety of network-enabled devices in your home, from your laptop and phone to your TV, Xbox, washing machine, and smart locks. But from the outside, your house has only one public IP address – the address of the router in your home. That means that your router has to keep track of all the devices you’ve got, but they don’t need to register with any sort of public service just to be able to use the internet.</p>
<p>As we’ll get into in <a href="3-4-dns.html">Chapter&nbsp;<span>13</span></a>, keeping track of IP Addresses is best left to machines. If you’re managing a complex private network, it’s really nice to give <em>hostnames</em> to individual hosts. A nice feature of a private hostname compared to a public address is that you don’t have to worry if the hostname is unique across the entire internet – it just has to be unique inside your private network.</p>
<section id="firewalls-allow-lists-and-other-security-settings" class="level3" data-number="12.3.1">
<h3 data-number="12.3.1" class="anchored" data-anchor-id="firewalls-allow-lists-and-other-security-settings"><span class="header-section-number">12.3.1</span> Firewalls, allow-lists, and other security settings</h3>
<p>One of the most basic ways to keep a server safe is to not allow traffic from the outside to come in. Generally that means that in addition to keeping the server ports themselves closed, you’ll also have a firewall up that defaults to all ports being closed.</p>
<p>In AWS, the basic level of protection for your server is called the security group. If you remember, we used a default security group in launching your server. When you want to go add more services to your server, you’ll have to open additional ports both on the server and in the security group.</p>
<p>In addition to keeping particular ports closed, you can also set your server to only allow incoming traffic from certain IP addresses. This is generally a very coarse way to do security, and rather fragile. For example, you could configure your server to only accept incoming requests from your office’s IP address, but what if someone needs to access the server from home or the office’s IP address is reassigned?</p>
<p>One thing that is <em>not</em> a security setting is just using a port that’s hard to guess. For example, you might think, “Well, if I were to put SSH on port 2943 instead of 22, that would be safer because it’s harder to guess!” I guess so, but it’s really just an illusion of security. There are ways to make your server safer. Choosing esoteric port numbers really isn’t it.</p>
</section>
</section>
<section id="how-packets-are-routed" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="how-packets-are-routed"><span class="header-section-number">12.4</span> How packets are routed</h2>
<p>The way packets travel from one computer to another is called routing. A router is a hardware or software device that route packets.</p>
<p>You can think of routers and public networks as existing in trees. Each router knows about the IP addresses downstream of it and also the single upstream <em>default address</em>.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>TODO: diagram of routers in trees</p>
<p>For example, the router in your house just keeps track of the actual devices that are attached to it. So if you were to print something from your laptop, the data would just go to your router and then to your printer.</p>
<p>On the other hand, when you look at a picture on Instagram, that traffic has to go over the public network. The default address for your home’s router is probably one owned by your internet service provider (ISP) for your neighborhood. And that router’s default address is probably also owned by your ISP, but for a broader network.</p>
<p>So your packet will get passed upstream to a sufficiently general network and then back downstream to the actual address you’re trying to reach.</p>
<p>Meanwhile, your computer just waits for a response. Once the server has a response to send, it comes back using the same technique. Obviously a huge difference between sending a letter to a penpal and using a computer network is the speed. Where sending a physical letter takes a minimum of days, sending and receiving packets over a network is so fast that the delay is imperceptible when you’re playing a multiplayer video game or collaborating on a document online.</p>
</section>
<section id="how-to-recognize-an-ip-address" class="level2" data-number="12.5">
<h2 data-number="12.5" class="anchored" data-anchor-id="how-to-recognize-an-ip-address"><span class="header-section-number">12.5</span> How to recognize an IP address</h2>
<p>You’ve probably seen IPv4 addresses many times. They’re four blocks of 8-bit fields (numbers between <code>0</code> and <code>255</code>) with dots in between, so they look something like <code>65.77.154.233</code>.</p>
<p>If you do the math, you’ll realize there are “only” about 4 billion of these. While we can stretch those 4 billion IP addresses to many more devices since most devices only have private IPs, we are indeed running out of public IPv4 addresses.</p>
<p>The good news is that smart people started planning for this a while ago. In the last few years, adoption of the new IPv6 standard has started. IPv6 addresses are eight blocks of hexadecimal (<code>0-9</code> + <code>a-f</code>) digits separated by colons, with certain rules that allow them to be shortened, so <code>4b01:0db8:85a3:0000:0000:8a2e:0370:7334</code> or <code>3da4:66a::1</code> are both examples of valid IPv6 addresses.</p>
<p>IPv6 will coexist with IPv4 for a few decades and we’ll eventually switch entirely to IPv6. There’s no worry about running out of IPv6 addresses any time soon, because the total quantity of IPv6 addresses is a number with 39 zeroes.</p>
<section id="reserved-ip-addresses" class="level3" data-number="12.5.1">
<h3 data-number="12.5.1" class="anchored" data-anchor-id="reserved-ip-addresses"><span class="header-section-number">12.5.1</span> Reserved IP Addresses</h3>
<p>Most IPv4 addresses are freely available to be assigned, but there are a few that you’ll see in particular contexts and it’s useful to know what they are.</p>
<p>The first IP address you’ll see a lot is <code>127.0.0.1</code>, also known as <code>localhost</code> or loopback. This is the way a machine refers to itself.</p>
<p>For example, if you open a Shiny app in RStudio Desktop, the app will pop up in a little window along with a notice that says</p>
<p><code>Listening on http://127.0.0.1:6311</code></p>
<p>That <code>http://127.0.0.1</code> is indicating that your computer is serving the Shiny app to itself on the localhost address.</p>
<p>There are also a few blocks of addresses that are reserved for use on private networks, so they’re never assigned in public.</p>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>127.0.0.1</td>
<td><code>localhost</code> or loopback – the machine that originated the request</td>
</tr>
<tr class="even">
<td><p>192.168.x.x</p>
<p>172.16.x.x.x</p>
<p>10.x.x.x</p></td>
<td>Protected address blocks used for private IP addresses.</td>
</tr>
</tbody>
</table>
<p>You don’t really need to remember these, but it’s very likely you’ve seen an address like <code>192.168.0.1</code> or <code>192.168.1.1</code> if you’ve ever tried to configure a router or modem for your home wifi.</p>
<p>Now you know why.</p>
</section>
</section>
<section id="basic-network-troubleshooting" class="level2" data-number="12.6">
<h2 data-number="12.6" class="anchored" data-anchor-id="basic-network-troubleshooting"><span class="header-section-number">12.6</span> Basic network troubleshooting</h2>
<p>Networking can be difficult to manage because there are so many layers where it can go awry. Let’s say you’ve configured a service on your server, but you just can’t seem to access it.</p>
<p>The <code>ping</code> command can be useful for checking whether your server is reachable on the network. For example, here’s what happens when I <code>ping</code> the domain where this book sits.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">&gt;</span> ping <span class="ex">-o</span> do4ds.com                                                                        </span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="ex">PING</span> do4ds.com <span class="er">(</span><span class="ex">185.199.110.153</span><span class="kw">)</span><span class="bu">:</span> 56 data bytes</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="ex">64</span> bytes from 185.199.110.153: icmp_seq=0 ttl=57 time=13.766 ms</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="ex">---</span> do4ds.com ping statistics <span class="at">---</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="ex">1</span> packets transmitted, 1 packets received, 0.0% packet loss</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="ex">round-trip</span> min/avg/max/stddev = 13.766/13.766/13.766/0.000 ms</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This looks great – it sent 1 packet to the server and got one back. That’s exactly what I want. Seeing an unreachable host or packet loss would be an indication that my networking probably isn’t configured correctly somewhere between me and the server. I generally like to use <code>ping</code> with the <code>-o</code> option for sending just <strong>o</strong>ne packet – as opposed to continuously trying.</p>
<p>If <code>ping</code> fails, it means that my server isn’t reachable. The things I’d want to check is that I have the URL for the server correct, that DNS is configured correctly (see <a href="3-4-dns.html">Chapter&nbsp;<span>13</span></a>), that I’ve correctly configured any firewalls to have the right ports open (Security Groups in AWS), and that any intermediate networking devices are properly configured (see more on proxies in <a href="../sec4/4-2-ent-networks.html">Chapter&nbsp;<span>17</span></a>).</p>
<p>If <code>ping</code> succeeds but I still can’t access the server, <code>curl</code> is good to check. <code>curl</code> actually attempts to fetch the website at a particular URL. It’s often useful to use <code>curl</code> with the <code>-I</code> option so it just returns a simple status report, not the full contents of what it finds there.</p>
<p>For example, here’s what I get when I <code>curl</code> CRAN from my machine.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a> <span class="op">&gt;</span> curl <span class="ex">-I</span> https://cran.r-project.org/                                                         </span>
<span id="cb2-2"><a href="#cb2-2"></a> </span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="ex">HTTP/1.1</span> 200 OK</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="ex">Date:</span> Sun, 15 Jan 2023 15:34:19 GMT</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="ex">Server:</span> Apache</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="ex">Last-Modified:</span> Mon, 14 Nov 2022 17:33:06 GMT</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="ex">ETag:</span> <span class="st">"35a-5ed71a1e393e7"</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="ex">Accept-Ranges:</span> bytes</span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="ex">Content-Length:</span> 858</span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="ex">Vary:</span> Accept-Encoding</span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="ex">Content-Type:</span> text/html</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The important thing here is that first line. The server is returning a <code>200</code> HTTP status code, which means all is well. For more on HTTP status codes and how to interpret them, see <a href="../sec1/1-4-apis.html">Chapter&nbsp;<span>4</span></a>.</p>
<p>If <code>ping</code> succeeds, but <code>curl</code> does not, it means that the server is up at the expected IP address, but the service is not accessible. At that point, you might check whether the right ports are accessible – it’s possible to (for example) have port 443 or 80 accessible on your server, but not the port you actually need for your service. You also might check on the server itself that the service is running and that it is running on the port you think it is.</p>
<p>If you’re running inside a container, you should check that you’ve properly configured the port inside container to be forwarded to the outside.</p>
</section>
<section id="comprehension-questions" class="level2" data-number="12.7">
<h2 data-number="12.7" class="anchored" data-anchor-id="comprehension-questions"><span class="header-section-number">12.7</span> Comprehension Questions</h2>
<ol type="1">
<li>What are the 4 components of a URL? What’s the significance of each?</li>
<li>What are the two things a router keeps track of? How does it use each of them?</li>
<li>Are there any inherent differences between public and private IP addresses?</li>
<li>What is the difference between an IP address and a port?</li>
<li>Let’s say you’ve got a server at 54.33.115.12. Draw a mind map of what happens when you try to SSH into the server. Your explanation should include the terms: IP Address, port, 22, default address, router, sever.</li>
</ol>
</section>
<section id="lab-making-it-accessible-in-one-place" class="level2" data-number="12.8">
<h2 data-number="12.8" class="anchored" data-anchor-id="lab-making-it-accessible-in-one-place"><span class="header-section-number">12.8</span> Lab: Making it accessible in one place</h2>
<p>Right now, the only way to get to the various services on our server is only possible via an SSH tunnel. That’s fine for you as you’re working with it – but doesn’t work well if you want to share with other folks.</p>
<p>Now, you could just open up the different ports each service is on and have people access them there – RStudio on <code>8787</code>, JupyterHub on <code>8000</code>, and the API on <code>8080</code>. But that’s not really ideal. That would mean your users would have to remember and use those ports.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you do want to try it to prove to yourself that this “works”, go to your server’s Security Group settings and add custom TCP rules allowing access to ports <code>8787</code>, <code>8000</code>, and <code>8080</code> from anywhere. If you visit <code>$SERVER_ADDRESS:8787</code> you should get RStudio, similarly with JupyterHub at <code>$SERVER_ADDRESS:8000</code>, and the API at <code>$SERVER_ADDRESS:8080</code>.</p>
<p>Ok, now close those ports back up so we can do this the right way.</p>
</div>
</div>
<p>So instead, we want all the traffic to come in one front door and for users to use convenient subpaths to reach the services. The tool to accomplish this kind of rerouting is called a <em>proxy</em>.</p>
<p>In our case, we’re just going to run a software proxy on our server that reroutes traffic to different ports on our server. We’re going to use Nginx – a very popular open source proxy.</p>
<p>TODO: Image of proxy</p>
<p>Proxies are an advanced networking topic. Most enterprise networks make extensive uses of proxies. For the data science workbench you’re configuring, you may also need to use a proxy because some open source tooling doesn’t support configuring SSL/HTTPS and don’t permit authentication.</p>
<p>Let’s get it configured.</p>
<section id="step-1-configure-nginx" class="level3" data-number="12.8.1">
<h3 data-number="12.8.1" class="anchored" data-anchor-id="step-1-configure-nginx"><span class="header-section-number">12.8.1</span> Step 1: Configure Nginx</h3>
<p>The first thing we’re going to do is to configure Nginx on our server. Configuring Nginx is pretty straightforward – you install Nginx, put the configuration file into place, and restart the service to pick up the changes. The hard part is figuring out the right configuration. I’ve tested these steps, and they should work for you the first time. But if they don’t, you’re about to learn about the pain of proxy debugging.</p>
<p>Here are the steps to configure your proxy on your server:</p>
<ol type="1">
<li>SSH into your server.</li>
<li>Install Nginx with <code>sudo apt install nginx</code>.</li>
<li>Save a backup of the default <code>nginx.conf</code>, <code>cp /etc/nginx/nginx.conf /etc/nginx/nginx-backup.conf</code>.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></li>
<li>Edit the Nginx configuration with <code>sudo vim /etc/nginx/nginx.conf</code> and replace it with:</li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>/etc/nginx/nginx.conf</strong></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="ex">user</span> www-data<span class="kw">;</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="ex">worker_processes</span> auto<span class="kw">;</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="ex">pid</span> /run/nginx.pid<span class="kw">;</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="ex">include</span> /etc/nginx/modules-enabled/<span class="pp">*</span>.conf<span class="kw">;</span></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="ex">events</span> {</span>
<span id="cb3-7"><a href="#cb3-7"></a>	<span class="ex">worker_connections</span> 768<span class="kw">;</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>	<span class="co"># multi_accept on;</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="er">}</span></span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="ex">http</span> {</span>
<span id="cb3-12"><a href="#cb3-12"></a></span>
<span id="cb3-13"><a href="#cb3-13"></a> <span class="ex">map</span> <span class="va">$http_upgrade</span> <span class="va">$connection_upgrade</span> {</span>
<span id="cb3-14"><a href="#cb3-14"></a>    		<span class="ex">default</span> upgrade<span class="kw">;</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>    		<span class="st">''</span>      close<span class="kw">;</span></span>
<span id="cb3-16"><a href="#cb3-16"></a>  <span class="er">}</span></span>
<span id="cb3-17"><a href="#cb3-17"></a></span>
<span id="cb3-18"><a href="#cb3-18"></a>  <span class="ex">server</span> {</span>
<span id="cb3-19"><a href="#cb3-19"></a>    <span class="ex">listen</span> 80<span class="kw">;</span></span>
<span id="cb3-20"><a href="#cb3-20"></a></span>
<span id="cb3-21"><a href="#cb3-21"></a>    <span class="ex">location</span> /rstudio/ {</span>
<span id="cb3-22"><a href="#cb3-22"></a>      <span class="co"># Needed only for a custom path prefix of /rstudio</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>      <span class="ex">rewrite</span> ^/rstudio/<span class="er">(</span><span class="bu">.</span><span class="pp">*</span><span class="kw">)</span><span class="ex">$</span> /<span class="va">$1</span> break<span class="kw">;</span></span>
<span id="cb3-24"><a href="#cb3-24"></a></span>
<span id="cb3-25"><a href="#cb3-25"></a>      <span class="co"># Use http here when ssl-enabled=0 is set in rserver.conf</span></span>
<span id="cb3-26"><a href="#cb3-26"></a>      <span class="ex">proxy_pass</span> http://localhost:8787<span class="kw">;</span></span>
<span id="cb3-27"><a href="#cb3-27"></a></span>
<span id="cb3-28"><a href="#cb3-28"></a>      <span class="ex">proxy_http_version</span> 1.1<span class="kw">;</span></span>
<span id="cb3-29"><a href="#cb3-29"></a>      <span class="ex">proxy_set_header</span> Upgrade <span class="va">$http_upgrade</span><span class="kw">;</span></span>
<span id="cb3-30"><a href="#cb3-30"></a>      <span class="ex">proxy_set_header</span> Connection <span class="va">$connection_upgrade</span><span class="kw">;</span></span>
<span id="cb3-31"><a href="#cb3-31"></a>      <span class="ex">proxy_read_timeout</span> 20d<span class="kw">;</span></span>
<span id="cb3-32"><a href="#cb3-32"></a></span>
<span id="cb3-33"><a href="#cb3-33"></a>      <span class="co"># Not needed if www-root-path is set in rserver.conf</span></span>
<span id="cb3-34"><a href="#cb3-34"></a>      <span class="ex">proxy_set_header</span> X-RStudio-Root-Path /rstudio<span class="kw">;</span></span>
<span id="cb3-35"><a href="#cb3-35"></a></span>
<span id="cb3-36"><a href="#cb3-36"></a>      <span class="co"># Optionally, use an explicit hostname and omit the port if using 80/443</span></span>
<span id="cb3-37"><a href="#cb3-37"></a>      <span class="ex">proxy_set_header</span> Host <span class="va">$host</span>:<span class="va">$server_port</span><span class="kw">;</span></span>
<span id="cb3-38"><a href="#cb3-38"></a>    <span class="er">}</span></span>
<span id="cb3-39"><a href="#cb3-39"></a></span>
<span id="cb3-40"><a href="#cb3-40"></a>    <span class="ex">location</span> /jupyter/ {</span>
<span id="cb3-41"><a href="#cb3-41"></a>      <span class="co"># </span><span class="al">NOTE</span><span class="co"> important to also set bind url of jupyterhub to /jupyter in its config</span></span>
<span id="cb3-42"><a href="#cb3-42"></a>      <span class="ex">proxy_pass</span> http://127.0.0.1:8000<span class="kw">;</span></span>
<span id="cb3-43"><a href="#cb3-43"></a></span>
<span id="cb3-44"><a href="#cb3-44"></a>      <span class="ex">proxy_redirect</span>   off<span class="kw">;</span></span>
<span id="cb3-45"><a href="#cb3-45"></a>      <span class="ex">proxy_set_header</span> X-Real-IP <span class="va">$remote_addr</span><span class="kw">;</span></span>
<span id="cb3-46"><a href="#cb3-46"></a>      <span class="ex">proxy_set_header</span> Host <span class="va">$host</span><span class="kw">;</span></span>
<span id="cb3-47"><a href="#cb3-47"></a>      <span class="ex">proxy_set_header</span> X-Forwarded-For <span class="va">$proxy_add_x_forwarded_for</span><span class="kw">;</span></span>
<span id="cb3-48"><a href="#cb3-48"></a>      <span class="ex">proxy_set_header</span> X-Forwarded-Proto <span class="va">$scheme</span><span class="kw">;</span></span>
<span id="cb3-49"><a href="#cb3-49"></a></span>
<span id="cb3-50"><a href="#cb3-50"></a>      <span class="co"># websocket headers</span></span>
<span id="cb3-51"><a href="#cb3-51"></a>      <span class="ex">proxy_set_header</span> Upgrade <span class="va">$http_upgrade</span><span class="kw">;</span></span>
<span id="cb3-52"><a href="#cb3-52"></a>      <span class="ex">proxy_set_header</span> Connection <span class="va">$connection_upgrade</span><span class="kw">;</span></span>
<span id="cb3-53"><a href="#cb3-53"></a>    <span class="er">}</span></span>
<span id="cb3-54"><a href="#cb3-54"></a></span>
<span id="cb3-55"><a href="#cb3-55"></a>    <span class="ex">location</span> /penguins/ {</span>
<span id="cb3-56"><a href="#cb3-56"></a>      <span class="ex">proxy_pass</span> http://127.0.0.1:8555/<span class="kw">;</span></span>
<span id="cb3-57"><a href="#cb3-57"></a>      <span class="ex">proxy_set_header</span> Host <span class="va">$host</span><span class="kw">;</span></span>
<span id="cb3-58"><a href="#cb3-58"></a>    <span class="er">}</span></span>
<span id="cb3-59"><a href="#cb3-59"></a>  <span class="er">}</span></span>
<span id="cb3-60"><a href="#cb3-60"></a><span class="er">}</span></span>
<span id="cb3-61"><a href="#cb3-61"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li>Test that your configuration is valid <code>sudo nginx -t</code>.</li>
<li>Start Nginx with <code>sudo systemctl start nginx</code>. If you see nothing all is well.</li>
</ol>
<p>If you need to change anything, update the config and then restart with <code>sudo systemctl restart nginx</code>.</p>
</section>
<section id="step-2-open-port-80" class="level3" data-number="12.8.2">
<h3 data-number="12.8.2" class="anchored" data-anchor-id="step-2-open-port-80"><span class="header-section-number">12.8.2</span> Step 2: Open port 80</h3>
<p>Now, if you try to go to your server, your browser will spin for a while and nothing will happen. That’s because the AWS security group still only allows SSH access on port <code>22</code>. We need to add a rule that will allow HTTP access on port <code>80</code>.</p>
<p>On the AWS console page for your instance, find the Security section and click into the security group for your instance. You want to add a new inbound HTTP rule that allows access on port <code>80</code> from anywhere. Make sure not to get rid of the rule that allows SSH access on <code>22</code>. You still need that one too.</p>
<p>Once you do this, you should be able to visit your server address and get the default Nginx landing page.</p>
</section>
<section id="step-3-configure-rstudio-server-and-jupyterhub-to-be-on-a-subpath" class="level3" data-number="12.8.3">
<h3 data-number="12.8.3" class="anchored" data-anchor-id="step-3-configure-rstudio-server-and-jupyterhub-to-be-on-a-subpath"><span class="header-section-number">12.8.3</span> Step 3: Configure RStudio Server and JupyterHub to be on a subpath</h3>
<p>Complex web apps like RStudio and JupyterHub frequently reroute people back to themselves. In general, they assume that they’re on the root path <code>/</code>. That’s not true in this case, so we’ve got to let them know about the subpath where they’re actually located.</p>
<p>Configuring RStudio Server is already done. The <code>X-RStudio-Root-Path</code> line in the Nginx configuration adds a header to each request coming through the proxy that tells RStudio Server that it’s on the <code>/rstudio</code> path.</p>
<p>Jupyter needs an explicit update to its own configuration to let it know that it’s on a subpath. Luckily it’s a very simple change. You can edit the Jupyter configuration with</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">sudo</span> vim /etc/jupyterhub/jupyterhub_config.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Find the line that reads <code># c.JupyterHub.bind_url = 'http://:8000'</code>.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can search in vim from normal mode with <code>/ &lt;thing you're searching for&gt;</code>. Go to the next hit with <code>n</code>.</p>
</div>
</div>
<p>Delete the <code>#</code> to uncomment the line and add the subpath on the end. If you’re using the <code>/jupyter</code> subpath and the default <code>8000</code> port, that line will read <code>c.JupyterHub.bind_url = 'http://:8000/jupyter'</code>.</p>
<p>JupyterHub should pick up the new config when it’s restarted with</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">sudo</span> systemctl restart jupyterhub</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-4-try-it-out" class="level3" data-number="12.8.4">
<h3 data-number="12.8.4" class="anchored" data-anchor-id="step-4-try-it-out"><span class="header-section-number">12.8.4</span> Step 4: Try it out!</h3>
<p>Now we should have each service configured on a subpath. RStudio Server at <code>/rstudio</code>, JupyterHub at <code>/jupyter</code>, and our machine learning API at <code>/penguins</code>. For example, with my server at <code>ec2-54-159-134-39.compute-1.amazonaws.com</code>, I can get to RStudio Server at <code>http://ec2-54-159-134-39.compute-1.amazonaws.com/rstudio</code>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>As of this writing, the machine learning API serves itself off of <code>/__docs__/</code>, so you actually won’t be able to access anything interesting at <code>/penguins</code>. Instead, you’ll find the API at <code>/penguins/__docs__/</code>.</p>
<p>This should be fixed before final publication of this book.</p>
</div>
</div>
<p>Note that right now, this server is on HTTP, which is not a best practice. In fact, it’s such a bad practice that your browser will probably autocorrect the url to start with <code>https</code> and it won’t work. You’ll have to manually correct it to <code>http</code>. Don’t leave it like this for long – make sure to make sure to configure <code>https</code> in <a href="3-5-ssl.html">Chapter&nbsp;<span>14</span></a> before doing anything real on this server.</p>
</section>
<section id="lab-extensions" class="level3" data-number="12.8.5">
<h3 data-number="12.8.5" class="anchored" data-anchor-id="lab-extensions"><span class="header-section-number">12.8.5</span> Lab Extensions</h3>
<p>If you’ve gone to the bare URL for your server, you’ve probably noticed that it’s just the default Nginx landing page, which is not very attractive.</p>
<p>You might want to create a landing page with links to the subpath by serving a static html page off of <code>/</code>. Or maybe you want one of the services at <code>/</code> and the others at a different subpath.</p>
<p>If you want to change the subpaths, the <code>location</code> lines in the <code>nginx.conf</code> define the subpaths where the services will be available. By changing those locations, you can change the paths where the services live or you could add another that serves a static web page.</p>
<p>You also could add a different service at a different path. Note that the <code>proxy_path</code> lines define the port where the service is running on the server. Depending on the service you’re configuring, there may be other configuration you’ll have to do, but that will vary on a service-by-service basis.</p>


</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>For this analogy to work, everyone lives in apartment buildings rather than standalone houses.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>TCP and IP are actually two separate protocols at different layers of the protocol stack. But they’re so closely linked that we can talk about them as one.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>One of the biggest ways the mail <em>is not</em> like packet switching is that your message gets chopped up among lots of different packets, which are routed independently, and are reassembled when they get where they’re going. Works well for computers, not so well for real-world mail. It’s also pretty much an irrelevant detail, since this whole process works quite invisibly.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Often it’s not a single server at the address – but it behaves like one. It could instead be a proxy in front of a cluster of servers or even more complicated routing. All that matters is that it behaves like a single server from the outside.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>There are actually a few different types of addresses used to do this. IP addresses are used for identifying network resources and the MAC address used for physical hardware. Your router is also responsible for assigning IP addresses to devices as they join the network via the dynamic host configuration protocol (DHCP). I’m glossing over all these details as they’re immaterial to the understanding important for this chapter.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>This is generally a good practice before you start messing with config files. Bad configuration is usually preferable to a service that can’t start at all because you’ve messed up the config so badly. It happens.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../chapters/sec3/3-2-linux-admin.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Basic Linux SysAdmin</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/sec3/3-4-dns.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">DNS allows for human-readable addresses</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2022, Alex K Gold</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/akgold/do4ds" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/alexkgold">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>